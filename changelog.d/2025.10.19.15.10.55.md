# Fix Kanban Commit Tracking Issue

## Problem

The kanban system was creating a new commit entry for EVERY task every time ANY task was changed. This caused the "last commit" field to be updated incorrectly and created duplicate entries in commit history.

## Root Cause

1. `TaskGitTracker.updateTaskCommitTracking()` always added new commit entries without checking for duplicates
2. Commit tracking was updated before checking if a git commit actually happened
3. All tasks were getting their commit history updated when only one task changed

## Solution

1. **Enhanced duplicate detection**: Modified `updateTaskCommitTracking()` to check if the last commit entry already has the same SHA and type, avoiding duplicates

2. **Conditional commit tracking**: Changed `updateStatus()` and `pushToTasks()` to only update commit tracking AFTER a successful git commit occurs

3. **Two-phase commit process**:
   - First commit: Actual task changes (status, content, etc.)
   - Second commit: Commit tracking metadata (only if first commit succeeded)

## Files Changed

- `packages/kanban/src/lib/task-git-tracker.ts`: Added duplicate detection logic
- `packages/kanban/src/lib/kanban.ts`: Modified status update and push operations

## Impact

- ✅ Task commit tracking now only updates when that specific task changes
- ✅ No more duplicate commit entries in task history
- ✅ "last commit" field accurately reflects the last change to THAT task
- ✅ Reduced git noise from unnecessary commit tracking updates
