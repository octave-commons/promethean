- refine compactor to use immutable typed interfaces and scheduled polling without loops while publishing typed snapshots
