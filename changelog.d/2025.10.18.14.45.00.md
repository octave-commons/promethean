# Fix shadow-conf path validation for legitimate relative paths

## Problem

The `pnpm gen:ecosystem` command was failing with "Directory traversal detected" errors when processing legitimate relative paths like `../packages/broker` from EDN files in `system/daemons/`.

## Root Cause

The `validatePathSecurity` function in `ecosystem-secure.ts` was too restrictive, rejecting any path containing `..` even when used in legitimate relative path contexts that would be resolved against a known safe base directory.

## Solution

Modified the `validatePathSecurity` function to accept an optional `allowRelativeTraversal` parameter that permits `..` sequences when validating relative paths that will be resolved against a trusted base directory. Updated the `resolveRelativePath` function to use this permissive validation.

## Changes

- Updated `validatePathSecurity` function signature to include `allowRelativeTraversal` parameter
- Modified `resolveRelativePath` to allow relative traversal for legitimate path resolution
- Maintained security boundaries through `validatePathBoundaries` function

## Verification

- `pnpm gen:ecosystem` now successfully generates PM2 configuration from `system/daemons/` EDN files
- Generated `ecosystem.config.mjs` contains 9 applications with properly resolved paths
- All referenced script files exist and configuration syntax is valid
