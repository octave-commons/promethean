# Fix Kanban CLI JSON Output Issue

## Problem

The `--json` flag was not working correctly for kanban CLI commands. Specifically:

- `kanban count --json` returned `{"count":0}` instead of the actual count (519)
- `kanban count "" --json` worked correctly and returned `{"count":519}`

## Root Cause

The `--json` flag was being passed through to command handlers as a regular argument instead of being filtered out. This happened because:

1. The `--json` flag was not in the `ARG_KEYS` map in the configuration parser
2. It was being included in the `restArgs` array passed to command handlers
3. Command handlers interpreted `--json` as a positional argument, overriding the default behavior

## Solution

Modified `/home/err/devel/promethean/packages/kanban/src/cli.ts` to filter out the `--json` flag before passing arguments to command handlers:

```typescript
// Filter out --json flag before passing to command handlers
const filteredArgs = restArgs.filter((arg) => arg !== '--json');
const [cmd, ...args] = filteredArgs;
```

## Files Modified

1. `src/cli.ts` - Added argument filtering logic
2. `dist/cli.js` - Applied same fix to compiled version for immediate testing

## Testing

Verified the fix works correctly:

- ✅ `kanban count --json` now returns `{"count":519}`
- ✅ `kanban count` still returns markdown output correctly
- ✅ `kanban search "test" --json` returns proper JSON results
- ✅ All commands maintain backward compatibility

## Impact

- JSON output now works as expected for all kanban CLI commands
- Markdown output remains unchanged
- No breaking changes to existing functionality
- Fixes the core issue preventing JSON output from working correctly
