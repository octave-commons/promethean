Refactor attachment embedding to accept DI config, download attachments, and
embed content using type-specific models
