# OpenCode SDK Agent Management Tools Integration

## Summary

Added comprehensive OpenCode SDK-compatible tools for unified agent management to the `@promethean/opencode-client` package.

## Changes Made

### New Files Created

- `src/factories/agent-management-factory.ts` - 9 OpenCode SDK tool factories
- `src/plugins/agent-management.ts` - OpenCode plugin with client injection
- `test-agent-plugin.mjs` - Plugin functionality test script

### Files Modified

- `src/factories/index.ts` - Added agent management factory exports
- `src/plugins/index.ts` - Integrated AgentManagementPlugin into plugin system
- `docs/unified-agent-management.md` - Added OpenCode SDK integration documentation

## Features Added

### OpenCode SDK Tools (9 tools)

1. **agent.createSession** - Create new agent session with task assignment
2. **agent.startSession** - Start an existing session
3. **agent.stopSession** - Stop a running session with optional message
4. **agent.sendMessage** - Send messages to agent sessions
5. **agent.closeSession** - Close and cleanup sessions
6. **agent.listSessions** - List all sessions with optional filtering
7. **agent.getSession** - Get detailed session information
8. **agent.getStats** - Get session statistics and metrics
9. **agent.cleanup** - Cleanup old sessions based on age

### Technical Implementation

- Uses OpenCode SDK `tool()` function pattern for proper tool creation
- Implements client injection following existing patterns (ollama.ts example)
- Returns JSON.stringify(results) for consistent OpenCode integration
- Full TypeScript support with proper parameter validation
- Error handling with meaningful error messages

### Integration Benefits

- Unified API across direct usage and OpenCode environments
- Consistent behavior and error handling
- Type safety for all tool parameters
- Complete agent lifecycle management via tools
- Seamless integration with existing OpenCode plugin system

## Testing

- Plugin builds successfully without errors
- Test script verifies all 9 tools are available and functional
- Session creation and listing operations work correctly
- Plugin properly integrated into main plugin system

## Usage

```typescript
// Tools available in OpenCode environment as:
// agent.createSession, agent.sendMessage, agent.listSessions, etc.

const result = await tools['agent.createSession']({
  task: 'Analyze codebase for security issues',
  options: { priority: 'high', files: ['src/auth/'] },
});
```

## Impact

This integration enables seamless agent management within OpenCode environments while maintaining the same powerful unified API available for direct usage.
