# Frontend Service PM2 Fix - 2025.10.20.20.20.00

## Issue

The @promethean-os/frontend-service package was failing to start in PM2 with repeated "MODULE_NOT_FOUND" errors.

## Root Cause Analysis

1. **Missing Build**: The package TypeScript source hadn't been compiled to JavaScript
2. **Incorrect PM2 Configuration**: The ecosystem.config.mjs was using `esbuild-register` for already-compiled JavaScript
3. **Wrong Working Directory**: PM2 was running from `/home/err/devel` instead of `/home/err/devel/promethean`
4. **Path Resolution**: The script path `packages/frontend-service/dist/index.js` was resolving to `/home/err/devel/packages/frontend-service/dist/index.js` instead of the correct `/home/err/devel/promethean/packages/frontend-service/dist/index.js`

## Fixes Applied

### 1. Built the TypeScript Package

```bash
pnpm --filter @promethean-os/frontend-service build
```

This compiled `src/index.ts` to `dist/index.js` and created the necessary distribution files.

### 2. Fixed PM2 Configuration

Updated `ecosystem.config.mjs`:

- Removed `esbuild-register` from args (not needed for compiled JS)
- Changed `cwd` from `".."` to `"."` to use the correct working directory
- Fixed duplicate configuration entries that were causing syntax errors

### 3. Restarted PM2 Service

- Deleted the old process to clear cached configuration
- Started fresh with the corrected configuration

## Verification

- Service is now running on port 3002 as expected
- Health endpoint responding: `{"status":"healthy","timestamp":"2025-10-20T20:18:13.497Z","service":"frontend-service"}`
- Version endpoint working: `{"version":"1.0.0"}`
- PM2 status shows stable with 0 restarts

## Notes

- The ClojureScript build still has issues with missing `typed.clojure` dependency, but this doesn't affect the TypeScript service
- The service is successfully serving the Fastify-based HTTP server with health checks and diagnostics
- Static file serving for other packages is configured and ready once those packages have built frontend assets
