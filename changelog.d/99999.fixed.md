BrokerClient handles connection setup in a single 'open' handler to avoid duplicate resolve calls.
