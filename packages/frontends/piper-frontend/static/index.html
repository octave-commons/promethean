<!doctype html>
<meta charset="utf-8"/>
<title>Piper – Pipelines</title>
<link rel="stylesheet" href="/ui/file-tree.css"/>
<script type="module">
import {
  applyDesignTokens,
  registerUiComponents,
} from '/js/ui-components/index.js';
applyDesignTokens();
registerUiComponents();
</script>
<style>
html, body { height: 100%; }
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  height: 100vh;
  display: flex;
  flex-direction: column;
}
#layout {
  display: flex;
  gap: 12px;
  align-items: stretch;
  height: 100%;
  overflow: hidden; /* contain scroll to panels */
  padding: 12px;
  box-sizing: border-box;
}
#sidebar { flex: 0 0 320px; overflow: auto; }
#rightbar { flex: 0 0 360px; overflow: auto; }
#content { flex: 1 1 auto; min-width: 0; display: flex; flex-direction: column; overflow: hidden; }
#content > section { flex: 1 1 auto; display: flex; flex-direction: column; min-height: 0; }
#editorTabs { flex: 0 0 auto; overflow: auto; }
#editor { flex: 1 1 auto; width: 100%; height: auto; overflow: auto; font-family: ui-monospace, monospace; font-size: 13px; line-height: 1.4; padding: 8px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
#editorStatus { flex: 0 0 auto; }
section { margin-bottom: 12px; }
pre, code { background:#f6f6f6; padding:8px; border-radius:6px; display:block; white-space: pre-wrap; }
button { padding:6px 12px; }
select { min-width: 420px; }
</style>
<h1>Piper – Pipelines</h1>
<div id="layout">
  <aside id="sidebar">
    <section style="min-height:0;">
      <h2>Files</h2>
      <file-tree id="fileTree"></file-tree>
      <small style="color:#666; display:block; margin-top:6px;">Checked files will be passed to step runs. Click a file to open it.</small>
    </section>
  </aside>
  <main id="content">
    <section>
      <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
        <h2 style="margin:0;">Editor</h2>
        <div>
          <button id="saveBtn">Save</button>
          <button id="revertBtn">Revert</button>
        </div>
      </div>
      <div id="editorTabs" style="display:flex; gap:6px; border-bottom:1px solid #ddd; padding:6px 0; overflow:auto;"></div>
      <textarea id="editor"></textarea>
      <div id="editorStatus" style="margin-top:6px; color:#666;"></div>
    </section>
  </main>
  <aside id="rightbar" style="flex:0 0 360px;">
    <section style="min-height: 0;">
      <h2>Pipelines</h2>
      <div id="pipelines"></div>
    </section>
    <section style="min-height: 0;">
      <h2>Logs</h2>
      <pre id="logs" style="overflow: auto;">(no logs)</pre>
    </section>
  </aside>
</div>
<script type="module" src="/js/main.js"></script>
