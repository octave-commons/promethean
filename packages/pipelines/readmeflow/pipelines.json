{
  "pipelines": [
    {
      "name": "readmes",
      "steps": [
        {
          "id": "rm-scan",
          "js": {
            "module": "packages/readmeflow/dist/01-scan.js",
            "args": { "root": "packages", "cache": ".cache/readmes" },
            "isolate": "worker"
          },
          "inputs": ["packages/**/package.json", "packages/**/tsconfig.json"],
          "inputSchema": "packages/readmeflow/schemas/io.schema.json"
        },
        {
          "id": "rm-outline",
          "deps": ["rm-scan"],
          "js": {
            "module": "packages/readmeflow/dist/02-outline.js",
            "args": { "cache": ".cache/readmes", "model": "qwen3:4b" },
            "isolate": "worker"
          },
          "env": {
            "OLLAMA_URL": "${OLLAMA_URL}"
          }
        },
        {
          "id": "rm-write",
          "deps": ["rm-outline"],
          "js": {
            "module": "packages/readmeflow/dist/03-write.js",
            "args": { "cache": ".cache/readmes", "mermaid": true },
            "isolate": "worker"
          },
          "outputs": ["packages/**/README.md"],
          "outputSchema": "packages/readmeflow/schemas/io.schema.json"
        },
        {
          "id": "rm-verify",
          "deps": ["rm-write"],
          "js": {
            "module": "packages/readmeflow/dist/04-verify.js",
            "args": {
              "root": "packages",
              "out": "docs/agile/reports/readmes",
              "max": 200
            },
            "isolate": "worker"
          },
          "inputs": ["packages/**/README.md"],
          "inputSchema": "packages/readmeflow/schemas/io.schema.json",
          "outputs": ["docs/agile/reports/readmes/*.md"],
          "outputSchema": "packages/readmeflow/schemas/io.schema.json"
        }
      ]
    }
  ]
}
