{
  "pipelines": [
    {
      "name": "buildfix",
      "steps": [
        {
          "id": "bf-build",
          "shell": "pnpm --filter @promethean/buildfix build",
          "inputs": [
            "packages/buildfix/tsconfig.json",
            "packages/buildfix/src/**/*"
          ],
          "inputSchema": "packages/buildfix/schemas/io.schema.json",
          "outputs": ["packages/buildfix/dist/**"],
          "outputSchema": "packages/buildfix/schemas/io.schema.json"
        },
        {
          "id": "bf-errors",
          "shell": "pnpm --filter @promethean/buildfix bf:01-errors --tsconfig tsconfig.json --out .cache/buildfix/errors.json",
          "inputs": [
            "tsconfig.json",
            "packages/**/{src,lib}/**/*.{ts,tsx,js,jsx}"
          ],
          "inputSchema": "packages/buildfix/schemas/io.schema.json",
          "outputs": [".cache/buildfix/errors.json"],
          "outputSchema": "packages/buildfix/schemas/io.schema.json"
        },
        {
          "id": "bf-iterate",
          "deps": ["bf-build", "bf-errors"],
          "shell": "pnpm --filter @promethean/buildfix bf:02-iterate --errors .cache/buildfix/errors.json --out .cache/buildfix --model qwen3:4b --max-cycles 5 --git per-error --commit-on always --branch-prefix buildfix --remote origin --push false --use-gh false --rollback-on-regress true",
          "env": {
            "OLLAMA_URL": "${OLLAMA_URL}"
          },
          "inputs": [
            ".cache/buildfix/errors.json",
            "tsconfig.json",
            "packages/**/{src,lib}/**/*.{ts,tsx,js,jsx}"
          ],
          "inputSchema": "packages/buildfix/schemas/io.schema.json",
          "outputs": [
            ".cache/buildfix/summary.json",
            ".cache/buildfix/history/**",
            ".cache/buildfix/snippets/**"
          ],
          "outputSchema": "packages/buildfix/schemas/io.schema.json"
        },
        {
          "id": "bf-report",
          "deps": ["bf-build", "bf-iterate"],

          "shell": "pnpm --filter @promethean/buildfix bf:03-report --summary .cache/buildfix/summary.json --history-root .cache/buildfix/history --out docs/agile/reports/buildfix",
          "inputs": [".cache/buildfix/summary.json"],
          "inputSchema": "packages/buildfix/schemas/io.schema.json",
          "outputs": ["docs/agile/reports/buildfix/*.md"],
          "outputSchema": "packages/buildfix/schemas/io.schema.json"
        }
      ]
    }
  ]
}
