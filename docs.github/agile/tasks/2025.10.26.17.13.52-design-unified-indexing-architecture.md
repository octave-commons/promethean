# Design Unified Indexing Architecture

## Overview
Create comprehensive design for unified indexing service that consolidates all current indexing implementations (OpenCode, file-system, Discord, indexer-core, indexer-service) into single coherent system with unified API and storage backend.

## Context
Based on comprehensive code review of current indexing architecture revealing:
- Highly fragmented architecture with multiple overlapping approaches
- Storage backend confusion (ChromaDB + MongoDB + ContextStore)
- No unified API across different indexers
- Redundant implementations and inconsistent data models
- Critical dual write consistency issues

## Acceptance Criteria
- [ ] Unified content model (IndexableContent interface) designed
- [ ] Single API specification for all indexing operations
- [ ] Storage backend consolidation plan (MongoDB + ChromaDB)
- [ ] Migration strategy from current fragmented approach
- [ ] Cross-domain search capability design
- [ ] Error handling and consistency guarantees

## Implementation Plan
1. **Phase 1**: Design unified content model and interfaces
2. **Phase 2**: Create unified API specification
3. **Phase 3**: Design storage consolidation strategy
4. **Phase 4**: Plan migration approach
5. **Phase 5**: Design cross-domain search capabilities

## Technical Details
### Current Issues to Address
- DualStoreManager silent failures in vector writes
- Multiple file scanning implementations
- Inconsistent event handling patterns
- No cross-domain search capability
- Redundant embedding generation

### Target Architecture
- Single UnifiedIndexingService class
- Unified IndexableContent interface
- MongoDB for documents, ChromaDB for vectors
- Consistent error handling and logging
- Cross-domain search and context compilation

## Dependencies
- Review current indexing implementations (completed)
- Analyze storage backend patterns (completed)
- Identify consolidation opportunities (completed)

## Risks
- Migration complexity from multiple systems
- Data consistency during transition
- Performance impact of unified approach
- Backward compatibility requirements

## Tags
indexing,architecture,design,consolidation,unified,epic:indexing

## Complexity Score
8 (requires breakdown into smaller slices)

## Status
incoming
