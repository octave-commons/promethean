---
uuid: "f9bc9fe0-8ee2-4ab9-8790-31f60b6680ac"
title: "Task f9bc9fe0"
slug: "2025.10.08.23.58.30-expand-utils-retry-tests"
status: "in_review"
priority: "P3"
labels: ["retry", "testing", "utils"]
created_at: "2025-10-13T06:32:03.264Z"
estimates:
  complexity: ""
  scale: ""
  time_to_completion: ""
---
















## Context

The `retry` helper in `@promethean/utils` already retries transient failures, but we lack
coverage for the `backoff` and `onRetry` options. Adding tests now guards against regressions
when tuning retry behavior.

## Definition of Done

- [x] Add AVA tests that verify `onRetry` receives the error, attempt count, and computed delay.
- [x] Add coverage ensuring custom `backoff` functions determine the delay passed to `sleep`.
- [x] Keep retry tests deterministic and fast (<50ms each).
- [x] All `@promethean/utils` tests continue to pass.

## Implementation Notes

- Exercises `backoff` with deterministic sequences (e.g., incremental delays) and assert via the `onRetry` hook.
- Use zero or low delays to maintain quick runtimes.
- Reuse existing retry helper exports from the package index; do not mock internals.















