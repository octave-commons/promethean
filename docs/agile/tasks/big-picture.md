---
uuid: "4f8859ce-a422-4e12-a9c2-0d52be105ab1"
title: "Big picture"
slug: "big-picture"
status: "incoming"
priority: "P3"
labels: ["docops", "labeled"]
created_at: "2025-10-12T22:46:41.455Z"
estimates:
  complexity: ""
  scale: ""
  time_to_completion: ""
---




























































































































































































































































































































































































## üóÇ Source

- Path: docs/labeled/2025.10.07.23.52.19.md

## üìù Context Summary

love this problem. here‚Äôs a concrete, ‚Äúdrop-in‚Äù architecture that gives you one gateway exposing OpenAI-compatible, Anthropic/Claude-compatible, and Ollama-compatible endpoints, while routing across multiple providers (OpenAI, Anthropic, OpenRouter, Together/HF endpoints, Z.ai, OpenVINO model server, Ollama local/cloud) with hard backpressure, rate-limit awareness, and ‚Äúnever 429 to the client‚Äîqueue instead.‚Äù

I‚Äôll show:

* the shape of the system (with a diagram),
* the model registry + capability routing,
* the rate-limit + backpressure scheduler,
* OpenAI/Claude/Ollama compatible HTTP handlers,
* TypeScript package layout (Promethean style: new packages, idempotent scripts, cached).

---

# Big picture

**Contract:**

* If *any* target is rate-limited, we **do not 429 to the client**. We **enqueue** and hold the HTTP response open (stream or non-stream).
* If a job exceeds a configurable `max_wait_ms`, then and only then we return a 429 with a friendly `retry_after`.

---

# Monorepo layout (TypeScript)

* **Always TypeScript**, new logic goes in new packages.
* **Idempotent scripts** in `apps/tools/*`.
* **Cache everything** (responses by input hash, embeddings, and rate bucket

## üìã Tasks

- [ ] Draft actionable subtasks from the summary
- [ ] Define acceptance criteria
- [ ] Link back to related labeled docs



























































































































































































































































































































































































