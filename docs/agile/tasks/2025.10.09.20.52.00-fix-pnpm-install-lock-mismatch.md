---
uuid: "2cd3400a-baac-42e3-85d4-faf0f69cb4e2"
title: "Restore pnpm install by syncing lockfile and dependency specs"
description: "pnpm install --frozen-lockfile fails because workspace package manifests drifted from the committed lockfile and referenced unpublished versions."
type: maintenance
priority: P1
points: 2
status: in_review
tags: [pnpm, lockfile, ci]
dependencies: []
assignees: []
created: 2025-10-09T20:52:00.958491Z
updated: 2025-10-09T20:52:00.958491Z
---

## Context

The `pnpm install --frozen-lockfile` step aborts immediately with `ERR_PNPM_OUTDATED_LOCKFILE`, citing
`packages/duck-tools/package.json`. The workspace also fails a non-frozen install because
`@promethean/omni-service` requested unpublished packages (`@types/uuid@^10.0.6`, `@fastify/helmet@^13.1.0`,
`@fastify/cors@^10.1.1`). These mismatches cause CI bootstrap to fail.

## Definition of Done

- [x] Replace the invalid dependency ranges in `@promethean/omni-service` with published versions.
- [x] Refresh `pnpm-lock.yaml` so its specifiers match the current workspace manifests.
- [x] Verify `pnpm install --frozen-lockfile --ignore-scripts` completes without reporting lockfile drift.

## Implementation Notes

- Updated `@fastify/cors` to `^11.1.0`, `@fastify/helmet` to `^13.0.2`, and `@types/uuid` to `^10.0.0` in `packages/omni-service`.
- Re-ran `pnpm install` (allowing scripts) to rewrite the lockfile to the latest workspace specifiers.
- Confirmed a frozen install (scripts ignored to dodge heavy postinstall tasks) reports no drift.
