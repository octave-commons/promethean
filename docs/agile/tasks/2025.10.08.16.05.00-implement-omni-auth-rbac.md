---
uuid: "1a148406-56c1-4178-a282-6ebe180c20a2"
title: "Task 1a148406"
slug: "2025.10.08.16.05.00-implement-omni-auth-rbac"
status: "todo"
priority: "P2"
labels: ["auth", "omni", "rbac", "security", "service"]
created_at: "2025-10-13T06:32:03.264Z"
estimates:
  complexity: ""
  scale: ""
  time_to_completion: ""
---





















## Context

The omni-service needs a unified authentication and authorization system that can be shared across all adapters (REST, GraphQL, WebSocket, MCP). This ensures consistent security policies and avoids duplicate auth logic.

## Definition of Done

- [ ] JWT-based authentication middleware
- [ ] Role-based access control (RBAC) system
- [ ] User context injection for all requests
- [ ] Permission checking utilities
- [ ] Auth configuration management
- [ ] Unit tests for auth flows

## Technical Details

**Auth Features:**

- JWT token validation and refresh
- Role hierarchy (admin, user, readonly, etc.)
- Resource-based permissions
- API key support for service-to-service auth
- Session management for WebSocket connections

**RBAC Structure:**

```typescript
interface Role {
  name: string;
  permissions: Permission[];
}

interface Permission {
  resource: string;
  actions: ('read' | 'write' | 'delete' | 'admin')[];
}
```

**Middleware Integration:**

- Fastify hooks for request auth
- GraphQL context auth
- WebSocket connection auth
- MCP HTTP transport auth

## Acceptance Criteria

- JWT tokens are validated correctly
- Role permissions are enforced
- Unauthorized requests are rejected with 401/403
- Auth context is available in all adapters
- Configuration supports multiple auth providers
- Tests cover auth success and failure scenarios




















