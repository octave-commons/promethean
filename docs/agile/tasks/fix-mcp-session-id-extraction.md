---
uuid: "9118a82b-fd8d-4cef-833b-658e16939012"
title: "Fix MCP stdio proxy session ID extraction"
slug: "fix-mcp-session-id-extraction"
status: "accepted"
priority: "P2"
labels: ["mcp", "tests", "session"]
<<<<<<< HEAD
created_at: "2025-10-12T22:46:41.457Z"
=======
created_at: "2025-10-12T21:40:23.578Z"
>>>>>>> bug/kanban-duplication-issues
estimates:
  complexity: ""
  scale: ""
  time_to_completion: ""
---









































































































































































































































































<<<<<<< HEAD



















































































































=======
>>>>>>> bug/kanban-duplication-issues
## Objective
Resolve the failing session ID extraction checks in the MCP stdio proxy negative test suites (`chatgpt-simulation-negative` and `stdio-proxy-timing-negative`). Current runs return `null`, indicating the proxy handshake or response parsing is broken.

## Acceptance Criteria
- [ ] Session ID extraction succeeds for all affected tests, returning a non-null identifier.
- [ ] Proxy handshake logic is documented and validated with new or updated tests.
- [ ] Task notes capture the defect cause and the fix applied.

## Related
- Blocked by: `mcp_stdio_proxy_review` (`3c3a6f8b-2a8d-4b3e-8d63-2b7d1e8f7a91`).
- Original blocker task: "MCP stdio proxy: code review + minimal hardening".


## Triage Notes (2025-10-10)
- Ran `pnpm exec ava src/tests/chatgpt-simulation-negative.test.ts src/tests/stdio-proxy-timing-negative.test.ts`.
- Stdio proxy logs no `mcp-session-id:` line; regex returns `null`, so proxy likely stopped emitting handshake banner after recent changes.
- Need to inspect initialization path (`StdioHttpProxy.initializeMcpServer` / logging) to ensure session IDs are still surfaced for clients.
- Subsequent tool list requests rely on session id; failing handshake blocks coverage for the rest of the suites.








































































































































































































































































<<<<<<< HEAD



















































































































=======
>>>>>>> bug/kanban-duplication-issues
