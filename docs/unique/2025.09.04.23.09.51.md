---
uuid: 7486204b-be33-4c58-b725-2b58b36f89c2
created_at: '2025-09-04T23:09:51Z'
filename: Obsidian Vault Optimization with Git Sparse Checkout
title: Obsidian Vault Optimization with Git Sparse Checkout
description: >-
  A practical solution to Obsidian's performance issues caused by large
  `node_modules` directories using Git's sparse-checkout and worktree features.
  This method ensures Obsidian only indexes necessary files by splitting the
  repository into two Git trees: one for development and another sparse vault
  that excludes build artifacts.
tags:
  - Obsidian
  - Git
  - sparse-checkout
  - performance
  - worktree
  - node_modules
  - file indexing
---
Yeah—you’re right about Obsidian: most “ignore/hide” knobs are cosmetic. Lots of plugins still walk the tree or touch APIs that see everything; performance tanks the moment a fat `node_modules/` sits anywhere inside the vault. People have begged for true “don’t index this folder” for years; the official stance is basically “we don’t fully support that,” and Obsidian treats dot-prefixed paths as hidden/ignored while still being pretty opinionated about what it indexes and exposes. ([Obsidian Forum][1])

Here’s a setup that actually works, without hacks Obsidian will trip over:

# The fix: split with a worktree **and** make the vault sparse

Use a second Git working tree for Obsidian **and** restrict what files even exist in that tree via `git sparse-checkout`. Obsidian (and its plugins) can’t slow down on files that literally aren’t in the filesystem view.

**Why this works**

* `git worktree` gives you a second directory pointing at the same repo/branch. ([The GitHub Blog][2])
* `git sparse-checkout` lets that directory contain *only* the docs you want Obsidian to see (e.g., `docs/`, `README.md`, `.obsidian/`). The rest—packages, builds, `node_modules/`—won’t even be materialized. ([Git][3], [The GitHub Blog][2])
* This avoids symlink shenanigans (Obsidian tends to follow them and the help docs actively discourage using them). ([Obsidian Forum][4], [Obsidian Help][5])

## One-time setup

From your main repo dir (your normal dev tree that *does* have `node_modules/`):

```bash
# 1) Create a second worktree for Obsidian
git worktree add ../vault main   # pick your branch

cd ../vault

# 2) Initialize sparse-checkout in cone mode (directory-based, faster)
git sparse-checkout init --cone

# 3) Allow only the folders/files Obsidian needs
# Example: only docs/, notes/, README.md, and the .obsidian config
git sparse-checkout set docs notes
# Add root-level files individually:
git sparse-checkout set docs notes
echo README.md >> .git/info/sparse-checkout
echo .obsidian >> .git/info/sparse-checkout
git sparse-checkout reapply  # ensure patterns take effect
```

You can also do it all with `set` in newer Git versions by listing directories and then adding root files as needed; see docs for exact behavior in cone mode. ([Git][3], [Ubuntu Manpages][6])

Now open **`../vault`** in Obsidian. There’s no `node_modules/` there—because the *directories that would contain them aren’t present at all*. Plugins can’t accidentally traverse them.

## Day-to-day

* Code, install, and build in your main tree (`repo/`).
* Write and browse notes in the vault tree (`vault/`).
* Both trees commit to the same branch/history; push/pull from either.
* If you later need another docs dir in the vault, just:

  ```bash
  cd ../vault
  git sparse-checkout add more-docs
  ```

## Why not the usual alternatives?

* **“Exclude files” / UI hiding**: does not fully stop parsing/indexing; multiple reports confirm it doesn’t prevent slowdowns with `node_modules/`. ([Obsidian Forum][1])
* **Dot-prefix tricks**: Obsidian *ignores* dot-folders, yes—but you can’t rename `node_modules` to `.node_modules` in a normal Node project. (Some package managers let weird layouts, but it’s brittle.) ([Obsidian Forum][7], [Reddit][8])
* **Symlinks**: Obsidian follows them; you’ll just drag the mess back in. The official help warns against symlinks for data-integrity reasons too. ([Obsidian Forum][4], [Obsidian Help][5])
* **OverlayFS/bind-mount hacks**: possible (people do overlay mounts to hide dirs), but it’s OS-specific plumbing and easy to misconfigure. The sparse-worktree approach is portable and repo-native. ([Obsidian Forum][9])

## If you want even tighter guardrails

* Keep a tiny script in `../vault` that fails if someone tries `pnpm i` there (cheap sanity check).
* If you absolutely must keep giant folders *inside* a vault someday, there’s a community **File Ignore** plugin that programmatically dot-prefixes paths to truly hide them—useful, but you don’t need it if you keep the junk out with sparse-checkout. ([Obsidian File Ignore][10], [GitHub][11])

---

Bottom line: you’re not imagining it; the only bullet-proof way to keep Obsidian (and all plugins) from touching heavy folders is to **not have those folders in the vault’s filesystem view**. A second worktree + sparse-checkout does exactly that—with zero vendor-lock hacks and minimal friction.

[1]: https://forum.obsidian.md/t/ignore-exclude-completely-files-or-a-folder-from-all-obsidian-indexers-and-parsers/52025?utm_source=chatgpt.com "Ignore/exclude completely files or a folder from all obsidian ..."
[2]: https://github.blog/open-source/git/bring-your-monorepo-down-to-size-with-sparse-checkout/?utm_source=chatgpt.com "Bring your monorepo down to size with sparse-checkout"
[3]: https://git-scm.com/docs/git-sparse-checkout?utm_source=chatgpt.com "git-sparse-checkout Documentation"
[4]: https://forum.obsidian.md/t/can-i-stop-obsidian-from-following-symlinks-in-a-folder-it-opens-as-a-vault/73264?utm_source=chatgpt.com "Can I stop Obsidian from following symlinks in a folder it ..."
[5]: https://help.obsidian.md/Symbolic%2Blinks%2Band%2Bjunctions?utm_source=chatgpt.com "Symbolic links and junctions"
[6]: https://manpages.ubuntu.com/manpages/jammy/man1/git-sparse-checkout.1.html?utm_source=chatgpt.com "git-sparse-checkout - Initialize and modify the ..."
[7]: https://forum.obsidian.md/t/links-to-files-starting-with-dot-break/43105?utm_source=chatgpt.com "Links to files starting with dot break - Bug reports"
[8]: https://www.reddit.com/r/ObsidianMD/comments/13wq5fr/any_tips_for_gitignore_style_exclusion_of_vault/?utm_source=chatgpt.com "Any tips for .gitignore style exclusion of vault directories?"
[9]: https://forum.obsidian.md/t/ignore-exclude-completely-files-or-a-folder-from-all-obsidian-indexers-and-parsers/52025?page=3&utm_source=chatgpt.com "Ignore/exclude completely files or a folder from all obsidian ..."
[10]: https://obsidian-file-ignore.kkuk.dev/?utm_source=chatgpt.com "Obsidian File Ignore: Hide Files, Exclude Folders & Boost Speed"
[11]: https://github.com/Feng6611/Obsidian-File-Ignore?utm_source=chatgpt.com "Feng6611/Obsidian-File-Ignore"
