---
task-id: TASK-20250828-230209-3b6e
title: Build board reconciler CLI (double-entry repair)
state: Breakdown
txn: 2025-08-28T23:02:09Z-3b6e
owner: err
priority: p2
size: m
epic: EPC-000
depends_on: ["TASK-20250828-225801-7f3a"]
labels: ["board:reconciler","lang:ts","safe:patch-first"]
due:
links:
  - https://publish.obsidian.md/help/Plugins/Kanban+plugin
artifacts:
  - docs/ops/design/board-reconciler.md
  - artifacts/board/patches/EXAMPLE-reconcile.patch
rationale: "When task note state and kanban column disagree, we must auto-generate patches and apply per policy. This keeps the board self-healing without agents touching the kanban doc."
proposed_transitions: ["Breakdown->Ready"]
hashtags:
  - task/TASK-20250828-230209-3b6e
  - board/kanban
  - state/Breakdown
  - owner/err
  - priority/p2
  - epic/EPC-000
---

## Context
- We maintain *double entry*: state in task note vs. membership in kanban columns.
- Reconciler compares, generates patches A (kanban move) and/or B (note update), applies per policy.

## Inputs / Artifacts
- Design doc: `docs/ops/design/board-reconciler.md`
- Example patch: `artifacts/board/patches/EXAMPLE-reconcile.patch`

## Definition of Done
- [ ] `board reconcile` CLI prints summary and writes patches before apply
- [ ] Policy `source_of_truth: task|board` supported
- [ ] Non-zero exit code on unresolved conflicts; opens a “Reconcile” task
- [ ] Unit tests for: in-sync, note-wins, board-wins, multi-item batch
- [ ] Logs capture txn ids for each fix

## Plan
1) Parse kanban doc → column→ids map.
2) Parse task notes → id→state map.
3) Diff → generate patches → apply per policy.
4) Tests + wire to nightly.

#task/TASK-20250828-230209-3b6e
#board/kanban
#state/Breakdown
#owner/err
#priority/p2
#epic/EPC-000
