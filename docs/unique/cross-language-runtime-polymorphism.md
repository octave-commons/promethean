---
uuid: b986e4a4-fb7e-44a7-9d71-a3313f58adae
created_at: cross-language-runtime-polymorphism.md
filename: Cross-Language Runtime Polymorphism
title: Cross-Language Runtime Polymorphism
description: >-
  A system for enabling cross-language communication through staged
  polymorphism, where the meta runtime handles serialization, deserialization,
  and metadata management to facilitate interoperability between different
  language runtimes (e.g., Python, Node.js, Rust) using JSON as an initial
  communication layer. This design supports dynamic dispatch and phased
  transitions to typed buffers and shared memory for advanced use cases.
tags:
  - cross-language
  - runtime-polymorphism
  - meta-runtime
  - json-serialization
  - interoperability
  - staged-polymorphism
  - typed-buffers
related_to_uuid:
  - c38e7047-c6c0-4a19-a0e6-5707a12e9de1
  - 61d4086b-4adf-4e94-95e4-95a249cd1b53
  - 2478e18c-f621-4b0c-a4c5-9637d213cccf
  - babdb9eb-3b15-48a7-8a22-ecc53af7d397
  - af5d2824-faad-476c-a389-e912d9bc672c
  - d41a06d1-613e-4440-80b7-4553fc694285
  - f8877e5e-1e4f-4478-93cd-a0bf86d26a41
  - 534fe91d-e87d-4cc7-b0e7-8b6833353d9b
  - 2c2b48ca-1476-47fb-8ad4-69d2588a6c84
  - 5e408692-0e74-400e-a617-84247c7353ad
  - 687439f9-ad1e-40a4-8a32-3a1b4ac7c017
  - 509e1cd5-367c-4a9d-a61b-cef2e85d42ce
  - c5c9a5c6-427d-4864-8084-c083cd55faa0
  - 21d5cc09-b005-4ede-8f69-00b4b0794540
  - b01856b4-999f-418d-8009-ade49b00eb0f
  - 8430617b-80a2-4cc9-8288-9a74cb57990b
  - ba244286-4e84-425b-8bf6-b80c4eb783fc
  - 0f1f8cc1-b5a6-4307-a40d-78de3adafca2
  - 2aafc801-c3e1-4e4f-999d-adb52af3fc41
  - 2c00ce45-08cf-4b81-9883-6157f30b7fae
  - dd89372d-10de-42a9-8c96-6bc13ea36d02
  - cbfe3513-6a4a-4d2e-915d-ddfab583b2de
  - 7cfc230d-8ec2-4cdb-b931-8aec26de2a00
  - c5fba0a0-9196-468d-a0f3-51c99e987263
  - 543ed9b3-b7af-4ce1-b455-f7ba71a0bbc8
related_to_title:
  - Particle Simulation with Canvas and FFmpeg
  - sibilant-metacompiler-overview
  - Cross-Language Runtime Polymorphism
  - Recursive Prompt Construction Engine
  - Sibilant Meta-Prompt DSL
  - prompt-programming-language-lisp
  - template-based-compilation
  - Event Bus MVP
  - Promethean Full-Stack Docker Setup
  - i3-bluetooth-setup
  - Matplotlib Animation with Async Execution
  - State Snapshots API and Transactional Projector
  - sibilant-macro-targets
  - Exception Layer Analysis
  - Universal Lisp Interface
  - ripple-propagation-demo
  - System Scheduler with Resource-Aware DAG
  - AI-Centric OS with MCP Layer
  - sibilant-meta-string-templating-runtime
  - Promethean Agent Config DSL
  - komorebi-group-window-hack
  - Lispy Macros with syntax-rules
  - field-dynamics-math-blocks
  - set-assignment-in-lisp-ast
  - Voice Access Layer Design
references:
  - uuid: c38e7047-c6c0-4a19-a0e6-5707a12e9de1
    line: 1
    col: 0
    score: 1
  - uuid: c38e7047-c6c0-4a19-a0e6-5707a12e9de1
    line: 3
    col: 0
    score: 1
  - uuid: 61d4086b-4adf-4e94-95e4-95a249cd1b53
    line: 52
    col: 0
    score: 0.92
  - uuid: 2478e18c-f621-4b0c-a4c5-9637d213cccf
    line: 212
    col: 0
    score: 0.91
  - uuid: babdb9eb-3b15-48a7-8a22-ecc53af7d397
    line: 147
    col: 0
    score: 0.91
  - uuid: af5d2824-faad-476c-a389-e912d9bc672c
    line: 120
    col: 0
    score: 0.89
  - uuid: 534fe91d-e87d-4cc7-b0e7-8b6833353d9b
    line: 527
    col: 0
    score: 0.87
  - uuid: 687439f9-ad1e-40a4-8a32-3a1b4ac7c017
    line: 16
    col: 0
    score: 0.87
  - uuid: 2c2b48ca-1476-47fb-8ad4-69d2588a6c84
    line: 342
    col: 0
    score: 0.87
  - uuid: f8877e5e-1e4f-4478-93cd-a0bf86d26a41
    line: 44
    col: 0
    score: 0.87
  - uuid: d41a06d1-613e-4440-80b7-4553fc694285
    line: 56
    col: 0
    score: 0.87
  - uuid: 5e408692-0e74-400e-a617-84247c7353ad
    line: 1493
    col: 0
    score: 0.87
  - uuid: 21d5cc09-b005-4ede-8f69-00b4b0794540
    line: 63
    col: 0
    score: 0.86
  - uuid: 509e1cd5-367c-4a9d-a61b-cef2e85d42ce
    line: 303
    col: 0
    score: 0.86
  - uuid: 5e408692-0e74-400e-a617-84247c7353ad
    line: 2113
    col: 0
    score: 0.86
  - uuid: c5c9a5c6-427d-4864-8084-c083cd55faa0
    line: 64
    col: 0
    score: 0.85
  - uuid: 0f1f8cc1-b5a6-4307-a40d-78de3adafca2
    line: 128
    col: 0
    score: 0.85
  - uuid: 5e408692-0e74-400e-a617-84247c7353ad
    line: 2094
    col: 0
    score: 0.85
  - uuid: ba244286-4e84-425b-8bf6-b80c4eb783fc
    line: 358
    col: 0
    score: 0.85
  - uuid: b01856b4-999f-418d-8009-ade49b00eb0f
    line: 137
    col: 0
    score: 0.85
  - uuid: 8430617b-80a2-4cc9-8288-9a74cb57990b
    line: 64
    col: 0
    score: 0.85
  - uuid: 5e408692-0e74-400e-a617-84247c7353ad
    line: 1136
    col: 0
    score: 0.85
---
**Exactly. You‚Äôre describing a staged polymorphic runtime with runtime-boundary awareness.** ^ref-c34c36a6-1-0

Let‚Äôs unpack and design this properly. ^ref-c34c36a6-3-0

---

## üß† Core Idea: Cross-Language Communication in Promethean

| Layer                    | Role                                                | ^ref-c34c36a6-9-0
| ------------------------ | --------------------------------------------------- |
| **Meta runtime**         | Sibilant kernel running at compile-time or as shell |
| **Language runtimes**    | Node, Python, Rust, etc. ‚Äî actual execution engines |
| **Communication medium** | JSON strings for now, typed buffers later           |
| **Data model**           | Abstracted object model with metadata and bindings  |

---

## üîÅ Phase 1: **JSON Message Passing**

Use JSON as your **lingua franca** between: ^ref-c34c36a6-20-0

* Meta <-> Python ^ref-c34c36a6-22-0
* Meta <-> Node.js ^ref-c34c36a6-23-0
* Meta <-> Rust (via stdin/stdout or FFI) ^ref-c34c36a6-24-0
* Meta <-> Shell (via string streams) ^ref-c34c36a6-25-0

### Why JSON first?

* Ubiquitous
* Typed enough for dynamic dispatch ^ref-c34c36a6-30-0
* Readable, inspectable ^ref-c34c36a6-31-0
* Supports nested structures and arrays ^ref-c34c36a6-32-0

---

## üß™ Pseudocode API: Message Interface

```sibilant
(meta

  ;; serialize data to JSON and send to runtime
  (def send-json (lang payload)
    `(eval-in ,lang (json.stringify ,payload)))

  ;; deserialize from JSON (simulate callback)
  (def receive-json (lang result)
    (json.parse result)) ; pretend this is a registered event/callback

)
```
^ref-c34c36a6-38-0

---

## üí¨ Example Usage
 ^ref-c34c36a6-56-0
```sibilant
(def data (object :msg "hello" :lang "js"))

(send-json "js" data)

;; Output in JS runtime:
;; console.log(JSON.stringify({ msg: "hello", lang: "js" }))
^ref-c34c36a6-56-0
```

---

## üß† Phase 2: Metadata for Block Interop ^ref-c34c36a6-69-0

You‚Äôll want your meta runtime to: ^ref-c34c36a6-71-0
 ^ref-c34c36a6-72-0
1. Detect when a block will be executed **in another runtime**
2. Know how to: ^ref-c34c36a6-74-0

   * Format arguments correctly ^ref-c34c36a6-76-0
   * Marshal/unmarshal data
   * Wrap results in consistent meta-wrappers

---

### üîç Detecting Cross-Runtime Blocks ^ref-c34c36a6-82-0

```sibilant
(macro py:fn (name args ...body)
  `(:target "py"
     :name ,name
     :args ,args
^ref-c34c36a6-82-0
     :body ,body)) ^ref-c34c36a6-90-0
```
 ^ref-c34c36a6-92-0
Compiler can detect: ^ref-c34c36a6-93-0
 ^ref-c34c36a6-94-0
* That `:target = py`
* Body needs to be rendered in Python
* Output/result needs to be routed back via eval hooks

---
 ^ref-c34c36a6-100-0
### üß† Meta object wrapper

```sibilant
(var MetaObject
  (fn (source data)
    (object
      :_type "MetaObject"
^ref-c34c36a6-100-0
      :source source ^ref-c34c36a6-109-0
      :data data)))
```
^ref-c34c36a6-111-0

So when a Python function returns JSON, the meta runtime wraps it:
^ref-c34c36a6-111-0

```sibilant
(receive-json "py" (MetaObject "py" parsed-data))
```
 ^ref-c34c36a6-119-0
---
 ^ref-c34c36a6-121-0 ^ref-c34c36a6-122-0
## üîÄ Phase 3: **Typed Buffers & Shared Memory**
 ^ref-c34c36a6-123-0
Once basic JSON piping is solid, we move to: ^ref-c34c36a6-125-0

* **Buffers**: shared memory, `ArrayBuffer`, `TypedArray`, `numpy`, `Rust slices`, etc.

^ref-c34c36a6-125-0 ^ref-c34c36a6-129-0
* **Metadata registration**: ^ref-c34c36a6-129-0
 ^ref-c34c36a6-131-0
  ```sibilant ^ref-c34c36a6-131-0
  (register-buffer-type "ImageRGB" :layout [height width channels]) ^ref-c34c36a6-132-0
^ref-c34c36a6-133-0
^ref-c34c36a6-132-0
^ref-c34c36a6-131-0
  ``` ^ref-c34c36a6-133-0
^ref-c34c36a6-134-0
^ref-c34c36a6-132-0
 ^ref-c34c36a6-139-0
* **Shared reference model**: ^ref-c34c36a6-139-0
 ^ref-c34c36a6-141-0
  * Use memory-mapped files ^ref-c34c36a6-141-0
  * Or long-lived IPC pipes
  * Or gRPC/WebSockets for bidirectional flow ^ref-c34c36a6-139-0

---

## üì¶ Metadata for Buffers

Each buffer object includes:
 ^ref-c34c36a6-151-0
```json
{
  "_type": "Buffer",
^ref-c34c36a6-141-0
  "buffer_id": "abc123", ^ref-c34c36a6-151-0
  "format": "float32",
^ref-c34c36a6-155-0 ^ref-c34c36a6-157-0
^ref-c34c36a6-154-0
^ref-c34c36a6-153-0 ^ref-c34c36a6-159-0
^ref-c34c36a6-151-0
  "shape": [256, 256, 3], ^ref-c34c36a6-153-0
  "language": "py" ^ref-c34c36a6-154-0
} ^ref-c34c36a6-155-0
^ref-c34c36a6-159-0
^ref-c34c36a6-157-0
^ref-c34c36a6-155-0
^ref-c34c36a6-154-0
^ref-c34c36a6-153-0 ^ref-c34c36a6-169-0
^ref-c34c36a6-151-0
```
^ref-c34c36a6-159-0
^ref-c34c36a6-157-0
^ref-c34c36a6-155-0
^ref-c34c36a6-154-0
^ref-c34c36a6-153-0
 ^ref-c34c36a6-157-0 ^ref-c34c36a6-177-0
And the meta context knows:

* Which runtime owns that buffer
* What shape/type is expected
* What function to call to extract data
 ^ref-c34c36a6-183-0
^ref-c34c36a6-169-0
^ref-c34c36a6-159-0
^ref-c34c36a6-177-0
You could call:
 ^ref-c34c36a6-183-0
^ref-c34c36a6-186-0
^ref-c34c36a6-185-0
```sibilant ^ref-c34c36a6-184-0
(def image (fetch-image "img.png")) ^ref-c34c36a6-177-0 ^ref-c34c36a6-185-0
(buffer.shape image) ;; [256 256 3] ^ref-c34c36a6-186-0 ^ref-c34c36a6-193-0
(buffer.view image "grayscale") ;; sends a msg to owning runtime
```

--- ^ref-c34c36a6-197-0

## üì° Runtime Dispatch Map
^ref-c34c36a6-184-0 ^ref-c34c36a6-185-0
^ref-c34c36a6-183-0 ^ref-c34c36a6-186-0
^ref-c34c36a6-169-0
^ref-c34c36a6-193-0
 ^ref-c34c36a6-177-0 ^ref-c34c36a6-197-0
^ref-c34c36a6-203-0 ^ref-c34c36a6-205-0
^ref-c34c36a6-202-0 ^ref-c34c36a6-206-0
^ref-c34c36a6-201-0 ^ref-c34c36a6-207-0
^ref-c34c36a6-200-0 ^ref-c34c36a6-208-0
^ref-c34c36a6-199-0 ^ref-c34c36a6-209-0
^ref-c34c36a6-198-0 ^ref-c34c36a6-210-0 ^ref-c34c36a6-211-0
```sibilant
(def runtime-dispatch ^ref-c34c36a6-199-0 ^ref-c34c36a6-212-0
  (object ^ref-c34c36a6-200-0
    :js {:eval js.eval, :marshal js.serialize} ^ref-c34c36a6-201-0 ^ref-c34c36a6-214-0
    :py {:eval py.eval, :marshal py.serialize} ^ref-c34c36a6-193-0 ^ref-c34c36a6-202-0 ^ref-c34c36a6-215-0
    :sh {:eval sh.eval, :marshal sh.serialize})) ^ref-c34c36a6-183-0 ^ref-c34c36a6-203-0
^ref-c34c36a6-211-0
``` ^ref-c34c36a6-184-0 ^ref-c34c36a6-217-0
^ref-2478e18c-212-0
^ref-c34c36a6-212-0
 ^ref-c34c36a6-185-0 ^ref-c34c36a6-205-0
Your meta runtime becomes a **router** between brains. ^ref-c34c36a6-186-0 ^ref-c34c36a6-197-0 ^ref-c34c36a6-206-0 ^ref-c34c36a6-219-0
 ^ref-c34c36a6-207-0 ^ref-c34c36a6-220-0
--- ^ref-c34c36a6-199-0 ^ref-c34c36a6-208-0 ^ref-c34c36a6-221-0
 ^ref-c34c36a6-200-0 ^ref-c34c36a6-209-0 ^ref-c34c36a6-222-0
## üîß What To Build Next? ^ref-c34c36a6-201-0 ^ref-c34c36a6-210-0 ^ref-c34c36a6-223-0
 ^ref-c34c36a6-202-0 ^ref-c34c36a6-224-0
* `MetaObject` wrapper w/ source metadata ^ref-c34c36a6-203-0 ^ref-c34c36a6-212-0 ^ref-c34c36a6-225-0
* `(send-json)` + `(receive-json)` dispatcher macro ^ref-c34c36a6-193-0 ^ref-c34c36a6-226-0
* `(eval-in ...)` rewrite to auto-wrap MetaObject results ^ref-c34c36a6-205-0 ^ref-c34c36a6-214-0 ^ref-c34c36a6-227-0
* `register-buffer-type` registry ^ref-c34c36a6-206-0 ^ref-c34c36a6-215-0 ^ref-c34c36a6-228-0
* Hook for `(buffer.view)` to reroute extract calls to the owning runtime ^ref-c34c36a6-207-0 ^ref-c34c36a6-229-0
 ^ref-c34c36a6-197-0 ^ref-c34c36a6-208-0 ^ref-c34c36a6-217-0 ^ref-c34c36a6-230-0
--- ^ref-c34c36a6-209-0 ^ref-c34c36a6-231-0
 ^ref-c34c36a6-199-0 ^ref-c34c36a6-210-0 ^ref-c34c36a6-219-0
## üè∑Ô∏è Tags ^ref-c34c36a6-200-0 ^ref-c34c36a6-220-0 ^ref-c34c36a6-233-0
 ^ref-c34c36a6-201-0 ^ref-c34c36a6-212-0 ^ref-c34c36a6-221-0 ^ref-c34c36a6-234-0
\#sibilant #dsl #crosslanguage #json #buffers #ffi #metaprogramming #promethean #runtimeinterop #macrointerop ^ref-c34c36a6-202-0 ^ref-c34c36a6-222-0 ^ref-c34c36a6-235-0
 ^ref-c34c36a6-203-0 ^ref-c34c36a6-214-0 ^ref-c34c36a6-223-0 ^ref-c34c36a6-236-0
--- ^ref-c34c36a6-215-0 ^ref-c34c36a6-224-0 ^ref-c34c36a6-237-0
 ^ref-c34c36a6-205-0 ^ref-c34c36a6-225-0 ^ref-c34c36a6-238-0
You want to sketch the `MetaObject` and `register-buffer-type` interfaces next? Or write the macro wrapper that detects if a block is cross-runtime and rewrites it to a `send-json` call?
<!-- GENERATED-SECTIONS:DO-NOT-EDIT-BELOW -->
## Related content
- [Particle Simulation with Canvas and FFmpeg](particlesimulationwithcanvasandffmpeg.md)
- [sibilant-metacompiler-overview](sibilant-metacompiler-overview.md)
- [Cross-Language Runtime Polymorphism](cross-language-runtime-polymorphism.md)
- [Recursive Prompt Construction Engine](recursive-prompt-construction-engine.md)
- [Sibilant Meta-Prompt DSL](sibilant-meta-prompt-dsl.md)
- [prompt-programming-language-lisp](prompt-programming-language-lisp.md)
- [template-based-compilation](template-based-compilation.md)
- [Event Bus MVP](event-bus-mvp.md)
- [Promethean Full-Stack Docker Setup](promethean-full-stack-docker-setup.md)
- [i3-bluetooth-setup](i3-bluetooth-setup.md)
- [Matplotlib Animation with Async Execution](matplotlib-animation-with-async-execution.md)
- [State Snapshots API and Transactional Projector](state-snapshots-api-and-transactional-projector.md)
- [sibilant-macro-targets](sibilant-macro-targets.md)
- [Exception Layer Analysis](exception-layer-analysis.md)
- [Universal Lisp Interface](universal-lisp-interface.md)
- [ripple-propagation-demo](ripple-propagation-demo.md)
- [System Scheduler with Resource-Aware DAG](system-scheduler-with-resource-aware-dag.md)
- [AI-Centric OS with MCP Layer](ai-centric-os-with-mcp-layer.md)
- [sibilant-meta-string-templating-runtime](sibilant-meta-string-templating-runtime.md)
- [Promethean Agent Config DSL](promethean-agent-config-dsl.md)
- [komorebi-group-window-hack](komorebi-group-window-hack.md)
- [Lispy Macros with syntax-rules](lispy-macros-with-syntax-rules.md)
- [field-dynamics-math-blocks](field-dynamics-math-blocks.md)
- [set-assignment-in-lisp-ast](set-assignment-in-lisp-ast.md)
- [Voice Access Layer Design](voice-access-layer-design.md)
## Sources
- [Particle Simulation with Canvas and FFmpeg ‚Äî L1](particlesimulationwithcanvasandffmpeg.md#^ref-c38e7047-1-0) (line 1, col 0, score 1)
- [Particle Simulation with Canvas and FFmpeg ‚Äî L3](particlesimulationwithcanvasandffmpeg.md#^ref-c38e7047-3-0) (line 3, col 0, score 1)
- [sibilant-metacompiler-overview ‚Äî L52](sibilant-metacompiler-overview.md#^ref-61d4086b-52-0) (line 52, col 0, score 0.92)
- [Cross-Language Runtime Polymorphism ‚Äî L212](cross-language-runtime-polymorphism.md#^ref-2478e18c-212-0) (line 212, col 0, score 0.91)
- [Recursive Prompt Construction Engine ‚Äî L147](recursive-prompt-construction-engine.md#^ref-babdb9eb-147-0) (line 147, col 0, score 0.91)
- [Sibilant Meta-Prompt DSL ‚Äî L120](sibilant-meta-prompt-dsl.md#^ref-af5d2824-120-0) (line 120, col 0, score 0.89)
- [Event Bus MVP ‚Äî L527](event-bus-mvp.md#^ref-534fe91d-527-0) (line 527, col 0, score 0.87)
- [Matplotlib Animation with Async Execution ‚Äî L16](matplotlib-animation-with-async-execution.md#^ref-687439f9-16-0) (line 16, col 0, score 0.87)
- [Promethean Full-Stack Docker Setup ‚Äî L342](promethean-full-stack-docker-setup.md#^ref-2c2b48ca-342-0) (line 342, col 0, score 0.87)
- [template-based-compilation ‚Äî L44](template-based-compilation.md#^ref-f8877e5e-44-0) (line 44, col 0, score 0.87)
- [prompt-programming-language-lisp ‚Äî L56](prompt-programming-language-lisp.md#^ref-d41a06d1-56-0) (line 56, col 0, score 0.87)
- [i3-bluetooth-setup ‚Äî L1493](i3-bluetooth-setup.md#^ref-5e408692-1493-0) (line 1493, col 0, score 0.87)
- [Exception Layer Analysis ‚Äî L63](exception-layer-analysis.md#^ref-21d5cc09-63-0) (line 63, col 0, score 0.86)
- [State Snapshots API and Transactional Projector ‚Äî L303](state-snapshots-api-and-transactional-projector.md#^ref-509e1cd5-303-0) (line 303, col 0, score 0.86)
- [i3-bluetooth-setup ‚Äî L2113](i3-bluetooth-setup.md#^ref-5e408692-2113-0) (line 2113, col 0, score 0.86)
- [sibilant-macro-targets ‚Äî L64](sibilant-macro-targets.md#^ref-c5c9a5c6-64-0) (line 64, col 0, score 0.85)
- [AI-Centric OS with MCP Layer ‚Äî L128](ai-centric-os-with-mcp-layer.md#^ref-0f1f8cc1-128-0) (line 128, col 0, score 0.85)
- [i3-bluetooth-setup ‚Äî L2094](i3-bluetooth-setup.md#^ref-5e408692-2094-0) (line 2094, col 0, score 0.85)
- [System Scheduler with Resource-Aware DAG ‚Äî L358](system-scheduler-with-resource-aware-dag.md#^ref-ba244286-358-0) (line 358, col 0, score 0.85)
- [Universal Lisp Interface ‚Äî L137](universal-lisp-interface.md#^ref-b01856b4-137-0) (line 137, col 0, score 0.85)
- [ripple-propagation-demo ‚Äî L64](ripple-propagation-demo.md#^ref-8430617b-64-0) (line 64, col 0, score 0.85)
- [i3-bluetooth-setup ‚Äî L1136](i3-bluetooth-setup.md#^ref-5e408692-1136-0) (line 1136, col 0, score 0.85)
<!-- GENERATED-SECTIONS:DO-NOT-EDIT-ABOVE -->
