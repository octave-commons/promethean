---
uuid: ab748541-020e-4a7e-b07d-28173bd5bea2
created_at: 2025.08.20.18.08.00.md
filename: Promethean-native config design
description: >-
  A lean Promethean implementation that retains core ergonomics (direnv,
  profiles, per-project overrides) while avoiding Codex's file rewrite issues.
  It uses TOML with schema validation and surgical trust store updates. Key
  improvements include parent fallbacks, deep merging, and sandbox policy
  enforcement.
tags:
  - config
  - toml
  - schema
  - trust
  - sandbox
  - profiles
  - direnv
  - merging
related_to_title:
  - shared-package-layout-clarification
  - universal-intention-code-fabric
  - RAG UI Panel with Qdrant and PostgREST
  - State Snapshots API and Transactional Projector
  - Promethean Event Bus MVP v0.1
  - System Scheduler with Resource-Aware DAG
  - set-assignment-in-lisp-ast
  - Recursive Prompt Construction Engine
  - Vectorial Exception Descent
  - Universal Lisp Interface
  - Provider-Agnostic Chat Panel Implementation
  - Prometheus Observability Stack
  - Protocol_0_The_Contradiction_Engine
  - Pure TypeScript Search Microservice
  - Reawakening Duck
  - Prompt_Folder_Bootstrap
  - Promethean Chat Activity Report
  - schema-evolution-workflow
  - graph-ds
  - sibilant-macro-targets
  - Promethean Agent Config DSL
  - Sibilant Meta-Prompt DSL
  - Lispy Macros with syntax-rules
  - Voice Access Layer Design
  - Pure-Node Crawl Stack with Playwright and Crawlee
  - Chroma-Embedding-Refactor
  - Exception Layer Analysis
  - heartbeat-simulation-snippets
  - ecs-offload-workers
  - Migrate to Provider-Tenant Architecture
  - Stateful Partitions and Rebalancing
  - Synchronicity Waves and Web
  - Dynamic Context Model for Web Components
  - Factorio AI with External Agents
  - Model Upgrade Calm-Down Guide
  - Cross-Language Runtime Polymorphism
  - Promethean Documentation Pipeline Overview
  - Layer1SurvivabilityEnvelope
  - polymorphic-meta-programming-engine
  - Promethean Web UI Setup
  - sibilant-metacompiler-overview
  - homeostasis-decay-formulas
  - Ice Box Reorganization
  - Functional Refactor of TypeScript Document Processing
  - komorebi-group-window-hack
  - Model Selection for Lightweight Conversational Tasks
  - heartbeat-fragment-demo
  - i3-bluetooth-setup
  - 'Polyglot S-expr Bridge: Python-JS-Lisp Interop'
  - template-based-compilation
  - Event Bus Projections Architecture
  - ecs-scheduler-and-prefabs
  - Obsidian Templating Plugins Integration Guide
  - Agent Reflections and Prompt Evolution
  - NPU Voice Code and Sensory Integration
  - Language-Agnostic Mirror System
  - Debugging Broker Connections and Agent Behavior
  - Local-Only-LLM-Workflow
  - WebSocket Gateway Implementation
  - Mongo Outbox Implementation
  - Cross-Target Macro System in Sibilant
  - mystery-lisp-search-session
  - Functional Embedding Pipeline Refactor
  - prompt-programming-language-lisp
  - Interop and Source Maps
  - promethean-system-diagrams
  - Local-Offline-Model-Deployment-Strategy
  - Docops Feature Updates
  - lisp-dsl-for-window-management
  - i3-layout-saver
  - observability-infrastructure-setup
  - EidolonField
  - compiler-kit-foundations
  - prom-lib-rate-limiters-and-replay-api
  - TypeScript Patch for Tool Calling Support
  - Event Bus MVP
  - Shared Package Structure
  - Refactor Frontmatter Processing
  - Promethean Pipelines
  - sibilant-meta-string-templating-runtime
  - i3-config-validation-methods
  - plan-update-confirmation
  - Ollama-LLM-Provider-for-Pseudo-Code-Transpiler
  - Promethean Full-Stack Docker Setup
  - ripple-propagation-demo
  - pm2-orchestration-patterns
  - Eidolon-Field-Optimization
  - Local-First Intention→Code Loop with Free Models
  - Eidolon Field Abstract Model
  - eidolon-field-math-foundations
  - Per-Domain Policy System for JS Crawler
  - Chroma Toolkit Consolidation Plan
  - Services
  - Promethean-Copilot-Intent-Engine
  - Self-Agency in AI Interaction
  - Duck's Self-Referential Perceptual Loop
  - js-to-lisp-reverse-compiler
  - 2d-sandbox-field
  - Promethean State Format
  - zero-copy-snapshots-and-workers
  - Admin Dashboard for User Management
  - Lisp-Compiler-Integration
  - markdown-to-org-transpiler
  - layer-1-uptime-diagrams
  - 'Promethean Pipelines: Local TypeScript-First Workflow'
  - Promethean Agent DSL TS Scaffold
  - JavaScript
  - field-dynamics-math-blocks
  - field-interaction-equations
  - Fnord Tracer Protocol
  - Diagrams
  - field-node-diagram-set
  - field-node-diagram-visualizations
  - field-node-diagram-outline
  - Math Fundamentals
  - ParticleSimulationWithCanvasAndFFmpeg
  - Matplotlib Animation with Async Execution
  - aionian-circuit-math
  - Board Walk – 2025-08-11
  - 'Agent Tasks: Persistence Migration to DualStore'
  - smart-chatgpt-thingy
  - Performance-Optimized-Polyglot-Bridge
  - Obsidian ChatGPT Plugin Integration Guide
  - Mathematical Samplers
  - OpenAPI Validation Report
  - Optimizing Command Limitations in System Design
  - Mathematics Sampler
  - Mindful Prioritization
  - Promethean Infrastructure Setup
  - file-watcher-auth-fix
  - Redirecting Standard Error
  - Unique Info Dump Index
  - Tooling
  - Duck's Attractor States
  - Creative Moments
  - DuckDuckGoSearchPipeline
  - eidolon-node-lifecycle
  - polyglot-repl-interface-layer
  - Promethean Dev Workflow Update
  - Obsidian ChatGPT Plugin Integration
  - Pipeline Enhancements
  - Promethean Data Sync Protocol
  - Smoke Resonance Visualizations
  - Tracing the Signal
related_to_uuid:
  - 36c8882a-badc-4e18-838d-2c54d7038141
  - c14edce7-0656-45b2-aaf3-51f042451b7d
  - e1056831-ae0c-460b-95fa-4cf09b3398c6
  - 509e1cd5-367c-4a9d-a61b-cef2e85d42ce
  - fe7193a2-a5f7-4b3c-bea0-bd028815fc2c
  - ba244286-4e84-425b-8bf6-b80c4eb783fc
  - c5fba0a0-9196-468d-a0f3-51c99e987263
  - babdb9eb-3b15-48a7-8a22-ecc53af7d397
  - d771154e-a7ef-44ca-b69c-a1626cf94fbf
  - b01856b4-999f-418d-8009-ade49b00eb0f
  - 43bfe9dd-d433-42ca-9777-f4c40eaba791
  - e90b5a16-d58f-424d-bd36-70e9bd2861ad
  - 9a93a756-6d33-45d1-aca9-51b74f2b33d2
  - d17d3a96-c84d-4738-a403-6c733b874da2
  - 59b5670f-36d3-4d34-8985-f3144b15347a
  - bd4f0976-0d5b-47f6-a20a-0601d1842dc1
  - 18344cf9-0c49-4a71-b6c8-b8d84d660fca
  - d8059b6a-c1ec-487d-8e0b-3ce33d6b4d06
  - 6620e2f2-de6d-45d8-a722-5d26e160b370
  - c5c9a5c6-427d-4864-8084-c083cd55faa0
  - 2c00ce45-08cf-4b81-9883-6157f30b7fae
  - af5d2824-faad-476c-a389-e912d9bc672c
  - cbfe3513-6a4a-4d2e-915d-ddfab583b2de
  - 543ed9b3-b7af-4ce1-b455-f7ba71a0bbc8
  - d527c05d-22e8-4493-8f29-ae3cb67f035b
  - 8b256935-02f6-4da2-a406-bf6b8415276f
  - 21d5cc09-b005-4ede-8f69-00b4b0794540
  - 23e221e9-d4fa-4106-8458-06db2595085f
  - 6498b9d7-bd35-4bd3-89fb-af1c415c3cd1
  - 54382370-1931-4a19-a634-46735708a9ea
  - 4330e8f0-5f46-4235-918b-39b6b93fa561
  - 91295f3a-a2af-4050-a2b8-4777ea70c32c
  - f7702bf8-f7db-473c-9a5b-8dbf66ad3b9e
  - a4d90289-798d-44a0-a8e8-a055ae12fb52
  - db74343f-8f84-43a3-adb2-499c6f00be1c
  - c34c36a6-80c9-4b44-a200-6448543b1b33
  - 3a3bf2c9-c0f6-4d7b-bf84-c83c70dece3f
  - 64a9f9f9-58ee-4996-bdaf-9373845c6b29
  - 7bed0b9a-8b22-4b1f-be81-054a179453cb
  - bc5172ca-7a09-42ad-b418-8e42bb14d089
  - 61d4086b-4adf-4e94-95e4-95a249cd1b53
  - 37b5d236-2b3e-4a95-a4e8-31655c3023ef
  - 291c7d91-da8c-486c-9bc0-bd2254536e2d
  - 1cfae310-35dc-49c2-98f1-b186da25d84b
  - dd89372d-10de-42a9-8c96-6bc13ea36d02
  - d144aa62-348c-4e5d-ae8f-38084c67ceca
  - dd00677a-2280-45a7-91af-0728b21af3ad
  - 5e408692-0e74-400e-a617-84247c7353ad
  - 63a1cc28-b85c-4ce2-b754-01c2bc0c0bc3
  - f8877e5e-1e4f-4478-93cd-a0bf86d26a41
  - cf6b9b17-bb91-4219-aa5c-172cba02b2da
  - c62a1815-c43b-4a3b-88e6-d7fa008a155e
  - b39dc9d4-63e2-42d4-bbcd-041ef3167bca
  - bb7f0835-c347-474f-bfad-eabd873b51ad
  - 5a02283e-4281-4930-9ca7-e27849de11bd
  - d2b3628c-6cad-4664-8551-94ef8280851d
  - 73d3dbf6-9240-46fd-ada9-cc2e7e00dc5f
  - 9a8ab57e-507c-4c6b-aab4-01cea1bc0501
  - e811123d-5841-4e52-bf8c-978f26db4230
  - 9c1acd1e-c6a4-4a49-a66f-6da8b1bc9333
  - 5f210ca2-54e9-445b-afe4-fb340d4992c5
  - 513dc4c7-e045-4123-ba2e-cf5ef0b7b4a3
  - a4a25141-6380-40b9-9cd7-b554b246b303
  - d41a06d1-613e-4440-80b7-4553fc694285
  - cdfac40c-00e4-458f-96a7-4c37d0278731
  - b51e19b4-1326-4311-9798-33e972bf626c
  - ad7f1ed3-c9bf-4e85-9eeb-6cc4b53155f3
  - cdbd21ee-25a0-4bfa-884c-c1b948e9b0b2
  - 2792d448-c3b5-4050-93dd-93768529d99c
  - c5c5ff1c-d1bc-45c7-8a84-55a4a847dfc5
  - 31f0166e-4631-45fa-aecd-b44e9a13f497
  - b4e64f8c-4dc9-4941-a877-646c5ada068e
  - 49d1e1e5-5d13-4955-8f6f-7676434ec462
  - 01b21543-7e03-4129-8fe4-b6306be69dee
  - aee4718b-9f8b-4635-a0c1-ef61c9bea8f1
  - 7b7ca860-780c-44fa-8d3f-be8bd9496fba
  - 534fe91d-e87d-4cc7-b0e7-8b6833353d9b
  - 66a72fc3-4153-41fc-84bd-d6164967a6ff
  - cfbdca2f-5ee8-4cad-a75e-0e017e8d9b77
  - 8b8e6103-30a4-4d66-b5f2-87db1612b587
  - 2aafc801-c3e1-4e4f-999d-adb52af3fc41
  - d28090ac-f746-4958-aab5-ed1315382c04
  - b22d79c6-825b-4cd3-b0d3-1cef0532bb54
  - b362e12e-2802-4e41-9a21-6e0c7ad419a2
  - 2c2b48ca-1476-47fb-8ad4-69d2588a6c84
  - 8430617b-80a2-4cc9-8288-9a74cb57990b
  - 51932e7b-4237-4756-bcae-8be6d535d0d1
  - 40e05c14-0db0-44c5-bf0a-2eece2f4c2a4
  - 871490c7-a050-429b-88b2-55dfeaa1f8d5
  - 5e8b2388-022b-46cf-952c-36ae9b8f0037
  - 008f2ac0-bfaa-4d52-9826-2d5e86c0059f
  - c03020e1-e3e7-48bf-aa7e-aa740c601b63
  - 5020e892-8f18-443a-b707-6d0f3efcfe22
  - 75ea4a6a-8270-488d-9d37-799c288e5f70
  - ae24a280-678e-4c0b-8cc4-56667fa04172
  - 49a9a860-944c-467a-b532-4f99186a8593
  - 71726f04-eb1c-42a5-a5fe-d8209de6e159
  - 58191024-d04a-4520-8aae-a18be7b94263
  - c710dc93-9fec-471b-bdee-bedbd360c67f
  - 23df6ddb-05cf-4639-8201-f8291f8a6026
  - 62bec6f0-4e13-4f38-aca4-72c84ba02367
  - 2901a3e9-96f0-497c-ae2c-775f28a702dd
  - cfee6d36-b9f5-4587-885a-cdfddb4f054e
  - ab54cdd8-13ce-4dcb-a9cd-da2d86e0305f
  - 4127189a-e0ab-436f-8571-cc852b8e9add
  - 6b63edca-7637-4fb0-bc85-d498c31cc46e
  - 5158f742-4a3b-466e-bfc3-d83517b64200
  - c1618c66-f73a-4e04-9bfa-ef38755f7acc
  - 7cfc230d-8ec2-4cdb-b931-8aec26de2a00
  - b09141b7-544f-4c8e-8f49-bf76cecaacbb
  - fc21f824-4244-4030-a48e-c4170160ea1d
  - 45cd25b5-ed36-49ab-82c8-10d0903e34db
  - 22b989d5-f4aa-4880-8632-709c21830f83
  - e9b27b06-f608-4734-ae6c-f03a8b1fcf5f
  - 1f32c94a-4da4-4266-8ac0-6c282cfb401f
  - c6e87433-ec5d-4ded-bb1a-fb8734a3cfd9
  - e018dd7a-1fb7-4732-9e67-cd8b2f0831cf
  - 687439f9-ad1e-40a4-8a32-3a1b4ac7c017
  - f2d83a77-7f86-4c56-8538-1350167a0c6c
  - 7aa1eb92-7f9a-485b-8218-9b553aa9eefc
  - 93d2ba51-8689-49ee-94e2-296092e48058
  - 2facccf8-69cf-4a7d-b24b-de966ec70283
  - f5579967-762d-4cfd-851e-4f71b4cb77a1
  - 1d3d6c3a-039e-4b96-93c1-95854945e248
  - 86a691ec-ca1f-4350-824c-0ded1f8ebe70
  - 5c152b08-6b69-4bb8-a1a7-66745789c169
  - 98c8ff62-6ea3-4172-9e8b-93913e5d4a7f
  - b5e0183e-c34b-44b2-8fc9-a740a1a8d4e2
  - 40185d05-010e-45e7-8c2d-2f879bf14218
  - 6deed6ac-2473-40e0-bee0-ac9ae4c7bff2
  - 9044701b-03c9-4a30-92c4-46b1bd66c11e
  - b3555ede-324a-4d24-a885-b0721e74babf
  - 30ec3ba6-fbca-4606-ac3e-89b747fbeb7c
  - 6cb4943e-8267-4e27-8618-2ce0a464d173
  - 13951643-1741-46bb-89dc-1beebb122633
  - 10d98225-12e0-4212-8e15-88b57cf7bee5
  - e979c50f-69bb-48b0-8417-e1ee1b31c0c0
  - 938eca9c-97e2-4bcc-8653-b0ef1a5ac7a3
  - 9c79206d-4cb9-4f00-87e0-782dcea37bc7
  - 03a5578f-d689-45db-95e9-11300e5eee6f
  - ca8e1399-77bf-4f77-82a3-3f703b68706d
  - e2135d9f-c69d-47ee-9b17-0b05e98dc748
  - 9fab9e76-e283-4c9d-a8cd-cb76892ea7ac
  - ac9d3ac5-9a6a-4180-a67f-1ab7e229d981
  - c3cd4f65-2bb3-4fca-a32e-2ac667e03f40
references:
  - uuid: 7b7ca860-780c-44fa-8d3f-be8bd9496fba
    line: 104
    col: 0
    score: 0.86
  - uuid: 8430617b-80a2-4cc9-8288-9a74cb57990b
    line: 64
    col: 0
    score: 0.85
  - uuid: b01856b4-999f-418d-8009-ade49b00eb0f
    line: 137
    col: 0
    score: 0.85
  - uuid: b01856b4-999f-418d-8009-ade49b00eb0f
    line: 172
    col: 0
    score: 0.86
  - uuid: e811123d-5841-4e52-bf8c-978f26db4230
    line: 318
    col: 0
    score: 0.86
  - uuid: f7702bf8-f7db-473c-9a5b-8dbf66ad3b9e
    line: 272
    col: 0
    score: 0.86
  - uuid: 2c2b48ca-1476-47fb-8ad4-69d2588a6c84
    line: 342
    col: 0
    score: 0.85
  - uuid: dd89372d-10de-42a9-8c96-6bc13ea36d02
    line: 132
    col: 0
    score: 0.85
  - uuid: 5020e892-8f18-443a-b707-6d0f3efcfe22
    line: 72
    col: 0
    score: 0.85
  - uuid: 63a1cc28-b85c-4ce2-b754-01c2bc0c0bc3
    line: 332
    col: 0
    score: 0.85
  - uuid: 7b7ca860-780c-44fa-8d3f-be8bd9496fba
    line: 35
    col: 0
    score: 0.87
  - uuid: 8b256935-02f6-4da2-a406-bf6b8415276f
    line: 66
    col: 0
    score: 0.87
  - uuid: 7b7ca860-780c-44fa-8d3f-be8bd9496fba
    line: 160
    col: 0
    score: 0.87
  - uuid: f8877e5e-1e4f-4478-93cd-a0bf86d26a41
    line: 21
    col: 0
    score: 0.85
  - uuid: 37b5d236-2b3e-4a95-a4e8-31655c3023ef
    line: 81
    col: 0
    score: 0.85
  - uuid: 37b5d236-2b3e-4a95-a4e8-31655c3023ef
    line: 61
    col: 0
    score: 0.85
  - uuid: b01856b4-999f-418d-8009-ade49b00eb0f
    line: 150
    col: 0
    score: 0.85
  - uuid: d144aa62-348c-4e5d-ae8f-38084c67ceca
    line: 52
    col: 0
    score: 0.85
  - uuid: 37b5d236-2b3e-4a95-a4e8-31655c3023ef
    line: 40
    col: 0
    score: 0.85
  - uuid: 54382370-1931-4a19-a634-46735708a9ea
    line: 39
    col: 0
    score: 0.87
  - uuid: 7b7ca860-780c-44fa-8d3f-be8bd9496fba
    line: 88
    col: 0
    score: 0.86
  - uuid: e90b5a16-d58f-424d-bd36-70e9bd2861ad
    line: 483
    col: 0
    score: 0.85
  - uuid: e90b5a16-d58f-424d-bd36-70e9bd2861ad
    line: 480
    col: 0
    score: 0.85
  - uuid: 7b7ca860-780c-44fa-8d3f-be8bd9496fba
    line: 115
    col: 0
    score: 0.85
  - uuid: 7b7ca860-780c-44fa-8d3f-be8bd9496fba
    line: 534
    col: 0
    score: 0.85
  - uuid: ba244286-4e84-425b-8bf6-b80c4eb783fc
    line: 374
    col: 0
    score: 0.9
  - uuid: 21d5cc09-b005-4ede-8f69-00b4b0794540
    line: 63
    col: 0
    score: 0.87
  - uuid: 2aafc801-c3e1-4e4f-999d-adb52af3fc41
    line: 92
    col: 0
    score: 0.88
  - uuid: 63a1cc28-b85c-4ce2-b754-01c2bc0c0bc3
    line: 490
    col: 0
    score: 0.86
  - uuid: 2c00ce45-08cf-4b81-9883-6157f30b7fae
    line: 279
    col: 0
    score: 0.88
  - uuid: c34c36a6-80c9-4b44-a200-6448543b1b33
    line: 211
    col: 0
    score: 0.89
  - uuid: bc5172ca-7a09-42ad-b418-8e42bb14d089
    line: 440
    col: 0
    score: 0.92
  - uuid: 9c1acd1e-c6a4-4a49-a66f-6da8b1bc9333
    line: 609
    col: 0
    score: 0.91
  - uuid: aee4718b-9f8b-4635-a0c1-ef61c9bea8f1
    line: 306
    col: 0
    score: 0.89
  - uuid: 23e221e9-d4fa-4106-8458-06db2595085f
    line: 80
    col: 0
    score: 0.88
  - uuid: cbfe3513-6a4a-4d2e-915d-ddfab583b2de
    line: 375
    col: 0
    score: 0.88
  - uuid: d527c05d-22e8-4493-8f29-ae3cb67f035b
    line: 400
    col: 0
    score: 0.9
  - uuid: 513dc4c7-e045-4123-ba2e-cf5ef0b7b4a3
    line: 106
    col: 0
    score: 0.91
  - uuid: b362e12e-2802-4e41-9a21-6e0c7ad419a2
    line: 151
    col: 0
    score: 0.88
  - uuid: 61d4086b-4adf-4e94-95e4-95a249cd1b53
    line: 52
    col: 0
    score: 0.91
  - uuid: 509e1cd5-367c-4a9d-a61b-cef2e85d42ce
    line: 303
    col: 0
    score: 0.87
  - uuid: b4e64f8c-4dc9-4941-a877-646c5ada068e
    line: 348
    col: 0
    score: 0.86
  - uuid: cfee6d36-b9f5-4587-885a-cdfddb4f054e
    line: 521
    col: 0
    score: 0.86
  - uuid: 6498b9d7-bd35-4bd3-89fb-af1c415c3cd1
    line: 427
    col: 0
    score: 0.86
  - uuid: 49d1e1e5-5d13-4955-8f6f-7676434ec462
    line: 205
    col: 0
    score: 0.88
  - uuid: 8b256935-02f6-4da2-a406-bf6b8415276f
    line: 289
    col: 0
    score: 0.86
  - uuid: 6b63edca-7637-4fb0-bc85-d498c31cc46e
    line: 220
    col: 0
    score: 0.86
  - uuid: d41a06d1-613e-4440-80b7-4553fc694285
    line: 56
    col: 0
    score: 0.9
  - uuid: c14edce7-0656-45b2-aaf3-51f042451b7d
    line: 388
    col: 0
    score: 0.91
  - uuid: 2c2b48ca-1476-47fb-8ad4-69d2588a6c84
    line: 416
    col: 0
    score: 0.86
  - uuid: e1056831-ae0c-460b-95fa-4cf09b3398c6
    line: 349
    col: 0
    score: 0.89
  - uuid: af5d2824-faad-476c-a389-e912d9bc672c
    line: 120
    col: 0
    score: 0.88
  - uuid: b01856b4-999f-418d-8009-ade49b00eb0f
    line: 187
    col: 0
    score: 0.89
  - uuid: 36c8882a-badc-4e18-838d-2c54d7038141
    line: 161
    col: 0
    score: 0.86
  - uuid: 9a8ab57e-507c-4c6b-aab4-01cea1bc0501
    line: 147
    col: 0
    score: 0.89
  - uuid: ab54cdd8-13ce-4dcb-a9cd-da2d86e0305f
    line: 272
    col: 0
    score: 0.86
  - uuid: 534fe91d-e87d-4cc7-b0e7-8b6833353d9b
    line: 524
    col: 0
    score: 0.86
  - uuid: 40e05c14-0db0-44c5-bf0a-2eece2f4c2a4
    line: 50
    col: 0
    score: 0.87
  - uuid: c710dc93-9fec-471b-bdee-bedbd360c67f
    line: 150
    col: 0
    score: 0.86
  - uuid: 543ed9b3-b7af-4ce1-b455-f7ba71a0bbc8
    line: 280
    col: 0
    score: 0.86
  - uuid: 7bed0b9a-8b22-4b1f-be81-054a179453cb
    line: 190
    col: 0
    score: 0.86
  - uuid: 51932e7b-4237-4756-bcae-8be6d535d0d1
    line: 217
    col: 0
    score: 0.88
  - uuid: 66a72fc3-4153-41fc-84bd-d6164967a6ff
    line: 185
    col: 0
    score: 0.89
  - uuid: e811123d-5841-4e52-bf8c-978f26db4230
    line: 630
    col: 0
    score: 0.89
  - uuid: d28090ac-f746-4958-aab5-ed1315382c04
    line: 28
    col: 0
    score: 0.85
  - uuid: fe7193a2-a5f7-4b3c-bea0-bd028815fc2c
    line: 972
    col: 0
    score: 0.88
  - uuid: b51e19b4-1326-4311-9798-33e972bf626c
    line: 169
    col: 0
    score: 0.9
  - uuid: c5c5ff1c-d1bc-45c7-8a84-55a4a847dfc5
    line: 185
    col: 0
    score: 0.9
  - uuid: d2b3628c-6cad-4664-8551-94ef8280851d
    line: 504
    col: 0
    score: 0.91
  - uuid: 4127189a-e0ab-436f-8571-cc852b8e9add
    line: 129
    col: 0
    score: 0.85
  - uuid: f8877e5e-1e4f-4478-93cd-a0bf86d26a41
    line: 44
    col: 0
    score: 0.88
  - uuid: cdfac40c-00e4-458f-96a7-4c37d0278731
    line: 497
    col: 0
    score: 0.9
  - uuid: a4a25141-6380-40b9-9cd7-b554b246b303
    line: 454
    col: 0
    score: 0.91
  - uuid: 3a3bf2c9-c0f6-4d7b-bf84-c83c70dece3f
    line: 401
    col: 0
    score: 0.91
  - uuid: cdbd21ee-25a0-4bfa-884c-c1b948e9b0b2
    line: 89
    col: 0
    score: 0.9
  - uuid: 2792d448-c3b5-4050-93dd-93768529d99c
    line: 151
    col: 0
    score: 0.9
  - uuid: 8b8e6103-30a4-4d66-b5f2-87db1612b587
    line: 420
    col: 0
    score: 0.89
  - uuid: b22d79c6-825b-4cd3-b0d3-1cef0532bb54
    line: 1435
    col: 0
    score: 0.88
  - uuid: 2792d448-c3b5-4050-93dd-93768529d99c
    line: 119
    col: 0
    score: 0.88
  - uuid: a4d90289-798d-44a0-a8e8-a055ae12fb52
    line: 495
    col: 0
    score: 0.88
  - uuid: 871490c7-a050-429b-88b2-55dfeaa1f8d5
    line: 105
    col: 0
    score: 0.86
  - uuid: 01b21543-7e03-4129-8fe4-b6306be69dee
    line: 588
    col: 0
    score: 0.89
  - uuid: babdb9eb-3b15-48a7-8a22-ecc53af7d397
    line: 147
    col: 0
    score: 0.85
  - uuid: 1cfae310-35dc-49c2-98f1-b186da25d84b
    line: 204
    col: 0
    score: 0.92
  - uuid: 6620e2f2-de6d-45d8-a722-5d26e160b370
    line: 427
    col: 0
    score: 0.92
  - uuid: dd00677a-2280-45a7-91af-0728b21af3ad
    line: 179
    col: 0
    score: 0.92
  - uuid: 37b5d236-2b3e-4a95-a4e8-31655c3023ef
    line: 200
    col: 0
    score: 0.92
  - uuid: 5e408692-0e74-400e-a617-84247c7353ad
    line: 201
    col: 0
    score: 0.92
  - uuid: 291c7d91-da8c-486c-9bc0-bd2254536e2d
    line: 120
    col: 0
    score: 0.92
  - uuid: dd89372d-10de-42a9-8c96-6bc13ea36d02
    line: 262
    col: 0
    score: 0.92
  - uuid: 64a9f9f9-58ee-4996-bdaf-9373845c6b29
    line: 201
    col: 0
    score: 0.92
  - uuid: d144aa62-348c-4e5d-ae8f-38084c67ceca
    line: 184
    col: 0
    score: 0.92
  - uuid: db74343f-8f84-43a3-adb2-499c6f00be1c
    line: 189
    col: 0
    score: 0.92
  - uuid: c5fba0a0-9196-468d-a0f3-51c99e987263
    line: 148
    col: 0
    score: 0.93
  - uuid: d771154e-a7ef-44ca-b69c-a1626cf94fbf
    line: 95
    col: 0
    score: 0.86
  - uuid: cfbdca2f-5ee8-4cad-a75e-0e017e8d9b77
    line: 11
    col: 0
    score: 0.89
  - uuid: 1cfae310-35dc-49c2-98f1-b186da25d84b
    line: 306
    col: 0
    score: 0.87
  - uuid: 62bec6f0-4e13-4f38-aca4-72c84ba02367
    line: 652
    col: 0
    score: 0.87
  - uuid: d17d3a96-c84d-4738-a403-6c733b874da2
    line: 859
    col: 0
    score: 0.87
  - uuid: 54382370-1931-4a19-a634-46735708a9ea
    line: 881
    col: 0
    score: 0.93
  - uuid: 4330e8f0-5f46-4235-918b-39b6b93fa561
    line: 937
    col: 0
    score: 0.93
  - uuid: 91295f3a-a2af-4050-a2b8-4777ea70c32c
    line: 214
    col: 0
    score: 0.93
  - uuid: f7702bf8-f7db-473c-9a5b-8dbf66ad3b9e
    line: 939
    col: 0
    score: 0.93
  - uuid: a4d90289-798d-44a0-a8e8-a055ae12fb52
    line: 568
    col: 0
    score: 0.93
  - uuid: db74343f-8f84-43a3-adb2-499c6f00be1c
    line: 371
    col: 0
    score: 0.93
  - uuid: 64a9f9f9-58ee-4996-bdaf-9373845c6b29
    line: 526
    col: 0
    score: 0.92
  - uuid: 3a3bf2c9-c0f6-4d7b-bf84-c83c70dece3f
    line: 505
    col: 0
    score: 0.92
  - uuid: 3a3bf2c9-c0f6-4d7b-bf84-c83c70dece3f
    line: 514
    col: 0
    score: 0.86
  - uuid: 49a9a860-944c-467a-b532-4f99186a8593
    line: 263
    col: 0
    score: 0.86
  - uuid: 5e8b2388-022b-46cf-952c-36ae9b8f0037
    line: 513
    col: 0
    score: 0.85
  - uuid: b39dc9d4-63e2-42d4-bbcd-041ef3167bca
    line: 317
    col: 0
    score: 0.91
  - uuid: bb7f0835-c347-474f-bfad-eabd873b51ad
    line: 417
    col: 0
    score: 0.91
  - uuid: 5a02283e-4281-4930-9ca7-e27849de11bd
    line: 117
    col: 0
    score: 0.91
  - uuid: 73d3dbf6-9240-46fd-ada9-cc2e7e00dc5f
    line: 266
    col: 0
    score: 0.91
  - uuid: 5e8b2388-022b-46cf-952c-36ae9b8f0037
    line: 674
    col: 0
    score: 0.87
  - uuid: f7702bf8-f7db-473c-9a5b-8dbf66ad3b9e
    line: 1053
    col: 0
    score: 0.87
  - uuid: 23df6ddb-05cf-4639-8201-f8291f8a6026
    line: 319
    col: 0
    score: 0.87
  - uuid: f7702bf8-f7db-473c-9a5b-8dbf66ad3b9e
    line: 1270
    col: 0
    score: 0.87
  - uuid: 2901a3e9-96f0-497c-ae2c-775f28a702dd
    line: 245
    col: 0
    score: 0.87
  - uuid: 8b8e6103-30a4-4d66-b5f2-87db1612b587
    line: 547
    col: 0
    score: 0.87
  - uuid: db74343f-8f84-43a3-adb2-499c6f00be1c
    line: 447
    col: 0
    score: 0.87
  - uuid: ae24a280-678e-4c0b-8cc4-56667fa04172
    line: 422
    col: 0
    score: 0.87
  - uuid: 3a3bf2c9-c0f6-4d7b-bf84-c83c70dece3f
    line: 656
    col: 0
    score: 0.87
  - uuid: 49a9a860-944c-467a-b532-4f99186a8593
    line: 301
    col: 0
    score: 0.87
  - uuid: 71726f04-eb1c-42a5-a5fe-d8209de6e159
    line: 182
    col: 0
    score: 0.87
  - uuid: 3a3bf2c9-c0f6-4d7b-bf84-c83c70dece3f
    line: 732
    col: 0
    score: 0.87
  - uuid: ae24a280-678e-4c0b-8cc4-56667fa04172
    line: 229
    col: 0
    score: 0.87
  - uuid: 31f0166e-4631-45fa-aecd-b44e9a13f497
    line: 79
    col: 0
    score: 0.87
  - uuid: 5f210ca2-54e9-445b-afe4-fb340d4992c5
    line: 148
    col: 0
    score: 0.91
  - uuid: ad7f1ed3-c9bf-4e85-9eeb-6cc4b53155f3
    line: 232
    col: 0
    score: 0.86
  - uuid: 5158f742-4a3b-466e-bfc3-d83517b64200
    line: 818
    col: 0
    score: 0.86
  - uuid: c62a1815-c43b-4a3b-88e6-d7fa008a155e
    line: 376
    col: 0
    score: 0.91
  - uuid: 5020e892-8f18-443a-b707-6d0f3efcfe22
    line: 636
    col: 0
    score: 0.85
  - uuid: 45cd25b5-ed36-49ab-82c8-10d0903e34db
    line: 502
    col: 0
    score: 0.85
  - uuid: c1618c66-f73a-4e04-9bfa-ef38755f7acc
    line: 396
    col: 0
    score: 0.85
  - uuid: c6e87433-ec5d-4ded-bb1a-fb8734a3cfd9
    line: 362
    col: 0
    score: 0.85
  - uuid: 75ea4a6a-8270-488d-9d37-799c288e5f70
    line: 283
    col: 0
    score: 0.85
  - uuid: 7cfc230d-8ec2-4cdb-b931-8aec26de2a00
    line: 877
    col: 0
    score: 0.85
  - uuid: b09141b7-544f-4c8e-8f49-bf76cecaacbb
    line: 907
    col: 0
    score: 0.85
  - uuid: 1f32c94a-4da4-4266-8ac0-6c282cfb401f
    line: 637
    col: 0
    score: 0.85
  - uuid: 22b989d5-f4aa-4880-8632-709c21830f83
    line: 648
    col: 0
    score: 0.85
  - uuid: e9b27b06-f608-4734-ae6c-f03a8b1fcf5f
    line: 538
    col: 0
    score: 0.85
  - uuid: fc21f824-4244-4030-a48e-c4170160ea1d
    line: 1018
    col: 0
    score: 0.85
  - uuid: 6620e2f2-de6d-45d8-a722-5d26e160b370
    line: 446
    col: 0
    score: 0.95
  - uuid: 18344cf9-0c49-4a71-b6c8-b8d84d660fca
    line: 145
    col: 0
    score: 0.95
  - uuid: e90b5a16-d58f-424d-bd36-70e9bd2861ad
    line: 599
    col: 0
    score: 0.95
  - uuid: bd4f0976-0d5b-47f6-a20a-0601d1842dc1
    line: 279
    col: 0
    score: 0.95
  - uuid: 9a93a756-6d33-45d1-aca9-51b74f2b33d2
    line: 250
    col: 0
    score: 0.95
  - uuid: 43bfe9dd-d433-42ca-9777-f4c40eaba791
    line: 315
    col: 0
    score: 0.95
  - uuid: d17d3a96-c84d-4738-a403-6c733b874da2
    line: 673
    col: 0
    score: 0.95
  - uuid: 59b5670f-36d3-4d34-8985-f3144b15347a
    line: 202
    col: 0
    score: 0.95
  - uuid: d8059b6a-c1ec-487d-8e0b-3ce33d6b4d06
    line: 662
    col: 0
    score: 0.95
  - uuid: c5c9a5c6-427d-4864-8084-c083cd55faa0
    line: 274
    col: 0
    score: 0.95
  - uuid: 58191024-d04a-4520-8aae-a18be7b94263
    line: 343
    col: 0
    score: 0.87
  - uuid: 5020e892-8f18-443a-b707-6d0f3efcfe22
    line: 524
    col: 0
    score: 0.87
  - uuid: 75ea4a6a-8270-488d-9d37-799c288e5f70
    line: 228
    col: 0
    score: 0.87
  - uuid: 008f2ac0-bfaa-4d52-9826-2d5e86c0059f
    line: 801
    col: 0
    score: 0.87
  - uuid: 54382370-1931-4a19-a634-46735708a9ea
    line: 1205
    col: 0
    score: 0.87
  - uuid: c03020e1-e3e7-48bf-aa7e-aa740c601b63
    line: 957
    col: 0
    score: 0.87
  - uuid: bd4f0976-0d5b-47f6-a20a-0601d1842dc1
    line: 819
    col: 0
    score: 0.87
  - uuid: d8059b6a-c1ec-487d-8e0b-3ce33d6b4d06
    line: 1028
    col: 0
    score: 0.87
  - uuid: 4330e8f0-5f46-4235-918b-39b6b93fa561
    line: 1089
    col: 0
    score: 0.87
  - uuid: cf6b9b17-bb91-4219-aa5c-172cba02b2da
    line: 111
    col: 0
    score: 0.91
---
Short answer: yes. We can rip out the good parts—config + profiles + trust + provider registry—and make them first‑class in Promethean, **without** inheriting Codex’s “rewrite your file” nonsense. ^ref-ab748541-1-0

Below is a lean, *Promethean-native* design and a drop‑in TypeScript implementation plan. It keeps your ergonomics (direnv, profiles, per‑project overrides) and avoids “last writer wins” hazards. ^ref-ab748541-3-0

---

# What to cannibalize (and how to make it better)

## 1) Config home resolution

**Codex idea worth keeping:** `$CODEX_HOME` (or fallback to `~/.codex`). ^ref-ab748541-11-0

**Promethean version:** `$PROM_HOME` (fallback `~/.promethean`), per‑project via `direnv`, plus **parent fallback** so you get inheritance if you want it. ^ref-ab748541-13-0

Resolution order: ^ref-ab748541-15-0

1. `$PROM_HOME` (if set) ^ref-ab748541-17-0
2. `./.promethean` (if present) ^ref-ab748541-18-0
3. `~/.promethean`

If multiple exist, load **all** and deep‑merge with clear precedence (CLI > project > user). Unlike Codex, we actually **merge**. ^ref-ab748541-21-0

---

## 2) File format + schema

Use TOML, but pin a schema and validate it (zod). Keep tables—not inline blobs—so we never fight the formatter. ^ref-ab748541-27-0

**Top-level (defaults):** ^ref-ab748541-29-0

* `model`, `model_provider` ^ref-ab748541-31-0
* `approval_policy` (`"untrusted" | "on-request" | "never" | "on-failure"`) ^ref-ab748541-32-0
* `sandbox_mode` (`"read-only" | "workspace-write"`) ^ref-ab748541-33-0
* `[sandbox_workspace_write]` → `network_access` (bool) ^ref-ab748541-34-0
* `preferred_auth_method` (`"apikey" | "chatgpt"`) ^ref-ab748541-35-0
* `disable_response_storage` (bool) ^ref-ab748541-36-0
* `[model_providers.<name>]` → `base_url`, `env_key`, `headers`, `query_params`, `wire_api` ^ref-ab748541-37-0
* `[mcp_servers.<name>]` → `command`, `args`, `env` ^ref-ab748541-38-0
* `[projects."<abs path>"]` → `trust_level = "trusted" | "untrusted"` ^ref-ab748541-39-0

**Profiles (named overlays):** ^ref-ab748541-41-0

* Same keys as top‑level **except** provider definitions; think “operational presets.” ^ref-ab748541-43-0

---

## 3) Profiles (done right)

* Declare under `[profiles.<name>]`. ^ref-ab748541-49-0
* Select via `--profile NAME` **or** `profile = "NAME"` at top‑level. ^ref-ab748541-50-0
* **Deep‑merge**: profile overrides top‑level; CLI dotted overrides trump both. ^ref-ab748541-51-0
* You can also do partial profile overlays: `--profile a --profile b` (later wins). (Codex doesn’t stack; we can.) ^ref-ab748541-52-0

---

## 4) Trust store that doesn’t trash your file

* Keep `projects` as multi‑line tables only. ^ref-ab748541-58-0
* Writes are **surgical** and **locked**: ^ref-ab748541-59-0

  * Acquire a file lock (`.lock`) in `$PROM_HOME`. ^ref-ab748541-61-0
  * Parse, modify just the `projects` section, and re‑emit with **preserved formatting** (use a concrete printer). ^ref-ab748541-62-0
  * No collapsing to inline; no reordering unrelated keys.

If concurrent: second process blocks, not clobbers. ^ref-ab748541-65-0

---

## 5) Provider registry

* Single interface for OpenAI‑compatible (OpenAI, Azure, Groq, Ollama). ^ref-ab748541-71-0
* Per‑provider config under `[model_providers.X]`. ^ref-ab748541-72-0
* At runtime, pick `model_provider` + `model`. ^ref-ab748541-73-0
* We centralize auth (env var lookup) and headers once. ^ref-ab748541-74-0

---

## 6) Sandbox policy (honest version)

* We can’t promise kernel Landlock/seccomp from Node; be upfront.
* Enforce a **policy gate** around dangerous ops (file write / spawn / network) and make every Promethean “capability” check the gate. ^ref-ab748541-81-0
* If `workspace-write` + `network_access=false`, block outbound requests unless a tool is annotated as “allowlisted”. ^ref-ab748541-82-0

---

# Minimal TS implementation (clean, testable)

## Folder layout

```
shared/ts/src/prom-config/
  index.ts
  schema.ts
  merge.ts
  filelock.ts
  trust.ts
  providers.ts
  cli-overrides.ts
```
^ref-ab748541-90-0 ^ref-ab748541-100-0

## 1) Schema (zod)
 ^ref-ab748541-103-0
```ts
// shared/ts/src/prom-config/schema.ts
import { z } from "zod";

export const Provider = z.object({
  name: z.string().optional(),
  base_url: z.string(),
  env_key: z.string().optional(),
  headers: z.record(z.string()).optional(),
  query_params: z.record(z.union([z.string(), z.number(), z.boolean()])).optional(),
  wire_api: z.enum(["responses", "chat-completions"]).optional(),
});

export const Projects = z.record(z.object({
  trust_level: z.enum(["trusted", "untrusted"]).default("trusted"),
}));

export const SandboxWrite = z.object({
  network_access: z.boolean().default(false),
}).partial();

export const Profile = z.object({
  model: z.string().optional(),
  model_provider: z.string().optional(),
  approval_policy: z.enum(["untrusted","on-request","never","on-failure"]).optional(),
  disable_response_storage: z.boolean().optional(),
  model_reasoning_effort: z.enum(["low","medium","high"]).optional(),
  model_reasoning_summary: z.enum(["off","brief","detailed"]).optional(),
  chatgpt_base_url: z.string().optional(),
  experimental_instructions_file: z.string().optional(),
  sandbox_mode: z.enum(["read-only","workspace-write"]).optional(),
  sandbox_workspace_write: SandboxWrite.optional(),
});

export const Config = z.object({
  profile: z.string().optional(),
  model: z.string().optional(),
  model_provider: z.string().optional(),
  approval_policy: z.enum(["untrusted","on-request","never","on-failure"]).optional(),
  sandbox_mode: z.enum(["read-only","workspace-write"]).optional(),
  sandbox_workspace_write: SandboxWrite.optional(),
  preferred_auth_method: z.enum(["apikey","chatgpt"]).optional(),
  disable_response_storage: z.boolean().optional(),
  model_providers: z.record(Provider).default({}),
  mcp_servers: z.record(z.object({
    command: z.string(),
    args: z.array(z.string()).default([]),
    env: z.record(z.string()).default({}),
  })).default({}),
  projects: Projects.default({}),
  profiles: z.record(Profile).default({}),
});
export type ConfigT = z.infer<typeof Config>;
^ref-ab748541-103-0
```

## 2) Load + merge + profile resolution ^ref-ab748541-160-0

```ts
// shared/ts/src/prom-config/index.ts
import fs from "fs";
import path from "path";
import * as toml from "@iarna/toml";
import { Config, ConfigT } from "./schema.js";
import { deepMerge } from "./merge.js";

const CANDIDATES = () => {
  const envHome = process.env.PROM_HOME;
  const local = path.resolve(".promethean/config.toml");
  const user = path.join(process.env.HOME || "", ".promethean", "config.toml");
  return [envHome && path.join(envHome, "config.toml"), local, user].filter(Boolean) as string[];
};

function readTomlIfExists(p: string): Partial<ConfigT> {
  try {
    const s = fs.readFileSync(p, "utf8");
    return Config.parse(toml.parse(s));
  } catch (e: any) {
    if (e.code === "ENOENT") return {};
    // Be loud on syntax errors
    throw new Error(`TOML parse failed at ${p}: ${e.message}`);
  }
}

export function loadConfig(cliOver: Record<string, unknown> = {}, profiles: string[] = []) {
  const layers = CANDIDATES().map(readTomlIfExists);
  const base = layers.reduce<Partial<ConfigT>>((acc, cur) => deepMerge(acc, cur), {});
  const selected = [
    ...(base.profile ? [base.profile] : []),
    ...profiles,
    ...(cliOver["profile"] ? [String(cliOver["profile"])] : []),
  ];

  let resolved = base;
  for (const name of selected) {
    if (!resolved.profiles?.[name]) continue;
    resolved = deepMerge(resolved, resolved.profiles[name] as any);
  }

  // Apply dotted CLI overrides last
  resolved = applyDottedOverrides(resolved, cliOver);

  // Validate final
  return Config.parse(resolved);
}

function applyDottedOverrides(cfg: any, over: Record<string, unknown>) {
  const out = structuredClone(cfg);
  for (const [k, v] of Object.entries(over)) {
    if (k === "profile") continue;
    setByPath(out, k, v);
  }
  return out;
}

function setByPath(obj: any, dotted: string, value: unknown) {
  const parts = dotted.split(".");
  let cur = obj;
  while (parts.length > 1) {
    const p = parts.shift()!;
    if (!(p in cur) || typeof cur[p] !== "object") cur[p] = {};
    cur = cur[p];
  }
  cur[parts[0]] = value;
^ref-ab748541-160-0
} ^ref-ab748541-229-0
```

`deepMerge` is the usual “objects merge, arrays replace” (keep it simple).
 ^ref-ab748541-233-0
## 3) Trust management (atomic, locked, no reflow)

```ts
// shared/ts/src/prom-config/trust.ts
import fs from "fs";
import path from "path";
import * as toml from "@iarna/toml";
import { Config } from "./schema.js";
import { withLock } from "./filelock.js";

const HOME = () => process.env.PROM_HOME ?? path.join(process.env.HOME || "", ".promethean");
const CFG = () => path.join(HOME(), "config.toml");

export async function setTrusted(absPath: string) {
  await withLock(path.join(HOME(), ".config.lock"), async () => {
    const cur = readConfigFile();
    cur.projects ??= {};
    cur.projects[absPath] = { trust_level: "trusted" };
    writeConfigFile(cur);
  });
}

function readConfigFile(): any {
  try {
    const s = fs.readFileSync(CFG(), "utf8");
    return toml.parse(s);
  } catch (e: any) {
    if (e.code === "ENOENT") return {};
    throw e;
  }
}

function writeConfigFile(doc: any) {
  // Preserve structure: force projects into table form
  if (doc.projects && !doc.projects.__table) {
    // no-op; @iarna/toml emits tables by default for objects
  }
  const tmp = CFG() + ".tmp";
  fs.mkdirSync(path.dirname(CFG()), { recursive: true });
  fs.writeFileSync(tmp, toml.stringify(doc));
^ref-ab748541-233-0
  fs.renameSync(tmp, CFG());
}
```
^ref-ab748541-275-0 ^ref-ab748541-278-0

```ts
// shared/ts/src/prom-config/filelock.ts
import fs from "fs/promises";
import { open } from "fs/promises";
import { constants } from "fs";

export async function withLock(lockPath: string, fn: () => Promise<void>) {
  await fs.mkdir(lockPath.replace(/\/[^/]+$/, ""), { recursive: true });
  const fd = await open(lockPath, constants.O_CREAT | constants.O_RDWR, 0o600);
  try {
    // Poor man's lock: rely on single-host discipline; swap with proper lockfile if needed
    await fn();
  } finally {
^ref-ab748541-275-0
    await fd.close(); ^ref-ab748541-293-0
  }
}
^ref-ab748541-293-0 ^ref-ab748541-297-0
```
^ref-ab748541-293-0

(If you want strict cross‑process locking, swap in `proper-lockfile` or `flock` via a tiny native wrapper. The skeleton above keeps it dependency‑light.)

## 4) Provider registry

```ts
// shared/ts/src/prom-config/providers.ts
import type { ConfigT } from "./schema.js";

export type ProviderCtx = {
  baseUrl: string;
  headers: Record<string,string>;
  query: Record<string,string|number|boolean>;
  wireApi: "responses" | "chat-completions";
};

export function resolveProvider(cfg: ConfigT): ProviderCtx {
  const name = cfg.model_provider ?? "openai";
  const p = cfg.model_providers[name];
  if (!p) throw new Error(`Unknown model_provider: ${name}`);
  const key = p.env_key ? process.env[p.env_key] : process.env.OPENAI_API_KEY;
  const headers: Record<string,string> = { "content-type": "application/json" };
  if (key) headers["authorization"] = `Bearer ${key}`;
  return {
    baseUrl: p.base_url,
    headers,
^ref-ab748541-297-0
    query: (p.query_params ?? {}) as any,
    wireApi: (p.wire_api ?? "responses") as any,
  };
^ref-ab748541-328-0
} ^ref-ab748541-330-0
^ref-ab748541-330-0
``` ^ref-ab748541-328-0
^ref-ab748541-305-0
^ref-ab748541-330-0 ^ref-ab748541-334-0
^ref-ab748541-328-0
^ref-ab748541-305-0 ^ref-ab748541-336-0
 ^ref-ab748541-334-0
---
 ^ref-ab748541-334-0 ^ref-ab748541-336-0
# CLI shim for Promethean
^ref-ab748541-330-0 ^ref-ab748541-336-0
 ^ref-ab748541-334-0
You can wrap your agents with a simple CLI:
 ^ref-ab748541-336-0
```bash
^ref-ab748541-344-0
^ref-ab748541-342-0 ^ref-ab748541-343-0 ^ref-ab748541-347-0
prom --profile full_auto -c sandbox_mode='"workspace-write"' -c sandbox_workspace_write.network_access=true run agent start ... ^ref-ab748541-344-0
``` ^ref-ab748541-342-0
 ^ref-ab748541-343-0
* `--profile` picks the bundle (model, approval policy). ^ref-ab748541-344-0 ^ref-ab748541-347-0
* `-c` flips the *operational* flags per run (write/net) without editing files. ^ref-ab748541-342-0
* Under the hood, the runner calls `loadConfig({ dotted overrides }, [profile])` → `resolveProvider(cfg)` → gate capabilities by `cfg.sandbox_*`. ^ref-ab748541-343-0 ^ref-ab748541-353-0
 ^ref-ab748541-344-0 ^ref-ab748541-347-0 ^ref-ab748541-354-0
--- ^ref-ab748541-355-0
 ^ref-ab748541-356-0
# Migration script (Codex → Promethean) ^ref-ab748541-347-0 ^ref-ab748541-353-0
 ^ref-ab748541-354-0
* Read `~/.codex/config.toml`. ^ref-ab748541-355-0
* Map like‑for‑like keys; keep providers, profiles, and projects. ^ref-ab748541-353-0 ^ref-ab748541-356-0
* Emit to `~/.promethean/config.toml` in **table** style for `projects`. ^ref-ab748541-354-0
* If `$CODEX_HOME` was used per‑project, copy into `./.promethean/config.toml` and set `PROM_HOME` via `direnv`. ^ref-ab748541-355-0 ^ref-ab748541-362-0
 ^ref-ab748541-353-0 ^ref-ab748541-356-0 ^ref-ab748541-363-0
I can write that as a 50‑line Node script when you’re ready. ^ref-ab748541-354-0
 ^ref-ab748541-355-0 ^ref-ab748541-365-0
--- ^ref-ab748541-356-0 ^ref-ab748541-362-0 ^ref-ab748541-366-0
 ^ref-ab748541-363-0 ^ref-ab748541-367-0
# Sharp edges (call them out) ^ref-ab748541-368-0
 ^ref-ab748541-362-0 ^ref-ab748541-365-0 ^ref-ab748541-369-0
* **Sandbox:** we’ll enforce at the capability layer; we’re not promising kernel isolation. That’s honest and testable. ^ref-ab748541-363-0 ^ref-ab748541-366-0
* **Locking:** use a real lock if you expect heavy concurrent writes (I can wire `flock` or `proper-lockfile`). ^ref-ab748541-367-0 ^ref-ab748541-371-0
* **Profiles stacking:** powerful, but keep it deterministic—later profile wins; log the final profile chain. ^ref-ab748541-362-0 ^ref-ab748541-365-0 ^ref-ab748541-368-0
* **Azure vs OpenAI names:** same caveat as Codex—Azure wants *deployment names*, not base model IDs. ^ref-ab748541-363-0 ^ref-ab748541-366-0 ^ref-ab748541-369-0
 ^ref-ab748541-367-0
--- ^ref-ab748541-365-0 ^ref-ab748541-368-0 ^ref-ab748541-371-0 ^ref-ab748541-375-0
 ^ref-ab748541-366-0 ^ref-ab748541-369-0 ^ref-ab748541-376-0
# Next steps I recommend (practical) ^ref-ab748541-367-0
 ^ref-ab748541-368-0 ^ref-ab748541-371-0 ^ref-ab748541-378-0
1. Drop the `shared/ts/src/prom-config` module above into your repo (fits your monorepo layout + your TS preference). ^ref-ab748541-369-0 ^ref-ab748541-375-0
2. Add a tiny `prom` CLI (Node) that: ^ref-ab748541-376-0 ^ref-ab748541-380-0

   * parses `--profile` and `-c dotted=val` flags, ^ref-ab748541-375-0 ^ref-ab748541-378-0
   * calls `loadConfig`, ^ref-ab748541-376-0
   * prints the resolved config (behind `--debug-config`), ^ref-ab748541-380-0 ^ref-ab748541-384-0
^ref-ab748541-371-0 ^ref-ab748541-375-0 ^ref-ab748541-378-0
   * then executes the requested subcommand with capability gates. ^ref-ab748541-376-0
3. Add `direnv` template:
 ^ref-ab748541-378-0
   ```sh
^ref-ab748541-385-0
^ref-ab748541-389-0
^ref-ab748541-385-0
^ref-ab748541-384-0
   # .envrc ^ref-ab748541-380-0
   export PROM_HOME=$PWD/.promethean ^ref-ab748541-384-0 ^ref-ab748541-389-0
   ``` ^ref-ab748541-385-0
4. Add a migration script from Codex TOML → Promethean TOML (I can produce it immediately if you want).
5. Convert one agent (Duck) to pull **model/provider + sandbox** from this new module; deprecate Codex in that path. ^ref-ab748541-384-0
 ^ref-ab748541-385-0
You get predictable merges, zero surprise rewrites, and the ergonomics you wanted (profiles + per‑project scope) without living inside Codex. ^ref-ab748541-389-0
 ^ref-ab748541-401-0
If you want, I’ll tailor the exact `config.toml` (global + project) and a `prom` CLI starter to your `Promethean` repo structure. #promethean #config #profiles #trust #direnv #devtools<!-- GENERATED-SECTIONS:DO-NOT-EDIT-BELOW -->
## Related content
- [shared-package-layout-clarification](shared-package-layout-clarification.md)
- [universal-intention-code-fabric](universal-intention-code-fabric.md)
- [RAG UI Panel with Qdrant and PostgREST](rag-ui-panel-with-qdrant-and-postgrest.md)
- [State Snapshots API and Transactional Projector](state-snapshots-api-and-transactional-projector.md)
- [Promethean Event Bus MVP v0.1](promethean-event-bus-mvp-v0-1.md)
- [System Scheduler with Resource-Aware DAG](system-scheduler-with-resource-aware-dag.md)
- [set-assignment-in-lisp-ast](set-assignment-in-lisp-ast.md)
- [Recursive Prompt Construction Engine](recursive-prompt-construction-engine.md)
- [Vectorial Exception Descent](vectorial-exception-descent.md)
- [Universal Lisp Interface](universal-lisp-interface.md)
- [Provider-Agnostic Chat Panel Implementation](provider-agnostic-chat-panel-implementation.md)
- [Prometheus Observability Stack](prometheus-observability-stack.md)
- [Protocol_0_The_Contradiction_Engine](protocol-0-the-contradiction-engine.md)
- [Pure TypeScript Search Microservice](pure-typescript-search-microservice.md)
- [Reawakening Duck](reawakening-duck.md)
- [Prompt_Folder_Bootstrap](prompt-folder-bootstrap.md)
- [Promethean Chat Activity Report](promethean-chat-activity-report.md)
- [schema-evolution-workflow](schema-evolution-workflow.md)
- [graph-ds](graph-ds.md)
- [sibilant-macro-targets](sibilant-macro-targets.md)
- [Promethean Agent Config DSL](promethean-agent-config-dsl.md)
- [Sibilant Meta-Prompt DSL](sibilant-meta-prompt-dsl.md)
- [Lispy Macros with syntax-rules](lispy-macros-with-syntax-rules.md)
- [Voice Access Layer Design](voice-access-layer-design.md)
- [Pure-Node Crawl Stack with Playwright and Crawlee](pure-node-crawl-stack-with-playwright-and-crawlee.md)
- [Chroma-Embedding-Refactor](chroma-embedding-refactor.md)
- [Exception Layer Analysis](exception-layer-analysis.md)
- [heartbeat-simulation-snippets](heartbeat-simulation-snippets.md)
- [ecs-offload-workers](ecs-offload-workers.md)
- [Migrate to Provider-Tenant Architecture](migrate-to-provider-tenant-architecture.md)
- [Stateful Partitions and Rebalancing](stateful-partitions-and-rebalancing.md)
- [Synchronicity Waves and Web](synchronicity-waves-and-web.md)
- [Dynamic Context Model for Web Components](dynamic-context-model-for-web-components.md)
- [Factorio AI with External Agents](factorio-ai-with-external-agents.md)
- [Model Upgrade Calm-Down Guide](model-upgrade-calm-down-guide.md)
- [Cross-Language Runtime Polymorphism](cross-language-runtime-polymorphism.md)
- [Promethean Documentation Pipeline Overview](promethean-documentation-pipeline-overview.md)
- [Layer1SurvivabilityEnvelope](layer1survivabilityenvelope.md)
- [polymorphic-meta-programming-engine](polymorphic-meta-programming-engine.md)
- [Promethean Web UI Setup](promethean-web-ui-setup.md)
- [sibilant-metacompiler-overview](sibilant-metacompiler-overview.md)
- [homeostasis-decay-formulas](homeostasis-decay-formulas.md)
- [Ice Box Reorganization](ice-box-reorganization.md)
- [Functional Refactor of TypeScript Document Processing](functional-refactor-of-typescript-document-processing.md)
- [komorebi-group-window-hack](komorebi-group-window-hack.md)
- [Model Selection for Lightweight Conversational Tasks](model-selection-for-lightweight-conversational-tasks.md)
- [heartbeat-fragment-demo](heartbeat-fragment-demo.md)
- [i3-bluetooth-setup](i3-bluetooth-setup.md)
- [Polyglot S-expr Bridge: Python-JS-Lisp Interop](polyglot-s-expr-bridge-python-js-lisp-interop.md)
- [template-based-compilation](template-based-compilation.md)
- [Event Bus Projections Architecture](event-bus-projections-architecture.md)
- [ecs-scheduler-and-prefabs](ecs-scheduler-and-prefabs.md)
- [Obsidian Templating Plugins Integration Guide](obsidian-templating-plugins-integration-guide.md)
- [Agent Reflections and Prompt Evolution](agent-reflections-and-prompt-evolution.md)
- [NPU Voice Code and Sensory Integration](npu-voice-code-and-sensory-integration.md)
- [Language-Agnostic Mirror System](language-agnostic-mirror-system.md)
- [Debugging Broker Connections and Agent Behavior](debugging-broker-connections-and-agent-behavior.md)
- [Local-Only-LLM-Workflow](local-only-llm-workflow.md)
- [WebSocket Gateway Implementation](websocket-gateway-implementation.md)
- [Mongo Outbox Implementation](mongo-outbox-implementation.md)
- [Cross-Target Macro System in Sibilant](cross-target-macro-system-in-sibilant.md)
- [mystery-lisp-search-session](mystery-lisp-search-session.md)
- [Functional Embedding Pipeline Refactor](functional-embedding-pipeline-refactor.md)
- [prompt-programming-language-lisp](prompt-programming-language-lisp.md)
- [Interop and Source Maps](interop-and-source-maps.md)
- [promethean-system-diagrams](promethean-system-diagrams.md)
- [Local-Offline-Model-Deployment-Strategy](local-offline-model-deployment-strategy.md)
- [Docops Feature Updates](docops-feature-updates-3.md)
- [Docops Feature Updates](docops-feature-updates.md)
- [lisp-dsl-for-window-management](lisp-dsl-for-window-management.md)
- [i3-layout-saver](i3-layout-saver.md)
- [observability-infrastructure-setup](observability-infrastructure-setup.md)
- [EidolonField](eidolonfield.md)
- [compiler-kit-foundations](compiler-kit-foundations.md)
- [prom-lib-rate-limiters-and-replay-api](prom-lib-rate-limiters-and-replay-api.md)
- [TypeScript Patch for Tool Calling Support](typescript-patch-for-tool-calling-support.md)
- [Event Bus MVP](event-bus-mvp.md)
- [Shared Package Structure](shared-package-structure.md)
- [Refactor Frontmatter Processing](refactor-frontmatter-processing.md)
- [Promethean Pipelines](promethean-pipelines.md)
- [sibilant-meta-string-templating-runtime](sibilant-meta-string-templating-runtime.md)
- [i3-config-validation-methods](i3-config-validation-methods.md)
- [plan-update-confirmation](plan-update-confirmation.md)
- [Ollama-LLM-Provider-for-Pseudo-Code-Transpiler](ollama-llm-provider-for-pseudo-code-transpiler.md)
- [Promethean Full-Stack Docker Setup](promethean-full-stack-docker-setup.md)
- [ripple-propagation-demo](ripple-propagation-demo.md)
- [pm2-orchestration-patterns](pm2-orchestration-patterns.md)
- [Eidolon-Field-Optimization](eidolon-field-optimization.md)
- [Local-First Intention→Code Loop with Free Models](local-first-intention-code-loop-with-free-models.md)
- [Eidolon Field Abstract Model](eidolon-field-abstract-model.md)
- [eidolon-field-math-foundations](eidolon-field-math-foundations.md)
- [Per-Domain Policy System for JS Crawler](per-domain-policy-system-for-js-crawler.md)
- [Chroma Toolkit Consolidation Plan](chroma-toolkit-consolidation-plan.md)
- [Services](chunks/services.md)
- [Promethean-Copilot-Intent-Engine](promethean-copilot-intent-engine.md)
- [Self-Agency in AI Interaction](self-agency-in-ai-interaction.md)
- [Duck's Self-Referential Perceptual Loop](ducks-self-referential-perceptual-loop.md)
- [js-to-lisp-reverse-compiler](js-to-lisp-reverse-compiler.md)
- [2d-sandbox-field](2d-sandbox-field.md)
- [Promethean State Format](promethean-state-format.md)
- [zero-copy-snapshots-and-workers](zero-copy-snapshots-and-workers.md)
- [Admin Dashboard for User Management](admin-dashboard-for-user-management.md)
- [Lisp-Compiler-Integration](lisp-compiler-integration.md)
- [markdown-to-org-transpiler](markdown-to-org-transpiler.md)
- [layer-1-uptime-diagrams](layer-1-uptime-diagrams.md)
- [Promethean Pipelines: Local TypeScript-First Workflow](promethean-pipelines-local-typescript-first-workflow.md)
- [Promethean Agent DSL TS Scaffold](promethean-agent-dsl-ts-scaffold.md)
- [JavaScript](chunks/javascript.md)
- [field-dynamics-math-blocks](field-dynamics-math-blocks.md)
- [field-interaction-equations](field-interaction-equations.md)
- [Fnord Tracer Protocol](fnord-tracer-protocol.md)
- [Diagrams](chunks/diagrams.md)
- [field-node-diagram-set](field-node-diagram-set.md)
- [field-node-diagram-visualizations](field-node-diagram-visualizations.md)
- [field-node-diagram-outline](field-node-diagram-outline.md)
- [Math Fundamentals](chunks/math-fundamentals.md)
- [ParticleSimulationWithCanvasAndFFmpeg](particlesimulationwithcanvasandffmpeg.md)
- [Matplotlib Animation with Async Execution](matplotlib-animation-with-async-execution.md)
- [aionian-circuit-math](aionian-circuit-math.md)
- [Board Walk – 2025-08-11](board-walk-2025-08-11.md)
- [Agent Tasks: Persistence Migration to DualStore](agent-tasks-persistence-migration-to-dualstore.md)
- [smart-chatgpt-thingy](smart-chatgpt-thingy.md)
- [Performance-Optimized-Polyglot-Bridge](performance-optimized-polyglot-bridge.md)
- [Obsidian ChatGPT Plugin Integration Guide](obsidian-chatgpt-plugin-integration-guide.md)
- [Mathematical Samplers](mathematical-samplers.md)
- [OpenAPI Validation Report](openapi-validation-report.md)
- [Optimizing Command Limitations in System Design](optimizing-command-limitations-in-system-design.md)
- [Mathematics Sampler](mathematics-sampler.md)
- [Mindful Prioritization](mindful-prioritization.md)
- [Promethean Infrastructure Setup](promethean-infrastructure-setup.md)
- [file-watcher-auth-fix](file-watcher-auth-fix.md)
- [Redirecting Standard Error](redirecting-standard-error.md)
- [Unique Info Dump Index](unique-info-dump-index.md)
- [Tooling](chunks/tooling.md)
- [Duck's Attractor States](ducks-attractor-states.md)
- [Creative Moments](creative-moments.md)
- [DuckDuckGoSearchPipeline](duckduckgosearchpipeline.md)
- [eidolon-node-lifecycle](eidolon-node-lifecycle.md)
- [polyglot-repl-interface-layer](polyglot-repl-interface-layer.md)
- [Promethean Dev Workflow Update](promethean-dev-workflow-update.md)
- [Obsidian ChatGPT Plugin Integration](obsidian-chatgpt-plugin-integration.md)
- [Pipeline Enhancements](pipeline-enhancements.md)
- [Promethean Data Sync Protocol](promethean-data-sync-protocol.md)
- [Smoke Resonance Visualizations](smoke-resonance-visualizations.md)
- [Tracing the Signal](tracing-the-signal.md)
## Sources
- [TypeScript Patch for Tool Calling Support — L104](typescript-patch-for-tool-calling-support.md#^ref-7b7ca860-104-0) (line 104, col 0, score 0.86)
- [ripple-propagation-demo — L64](ripple-propagation-demo.md#^ref-8430617b-64-0) (line 64, col 0, score 0.85)
- [Universal Lisp Interface — L137](universal-lisp-interface.md#^ref-b01856b4-137-0) (line 137, col 0, score 0.85)
- [Universal Lisp Interface — L172](universal-lisp-interface.md#^ref-b01856b4-172-0) (line 172, col 0, score 0.86)
- [WebSocket Gateway Implementation — L318](websocket-gateway-implementation.md#^ref-e811123d-318-0) (line 318, col 0, score 0.86)
- [Dynamic Context Model for Web Components — L272](dynamic-context-model-for-web-components.md#^ref-f7702bf8-272-0) (line 272, col 0, score 0.86)
- [Promethean Full-Stack Docker Setup — L342](promethean-full-stack-docker-setup.md#^ref-2c2b48ca-342-0) (line 342, col 0, score 0.85)
- [komorebi-group-window-hack — L132](komorebi-group-window-hack.md#^ref-dd89372d-132-0) (line 132, col 0, score 0.85)
- [Chroma Toolkit Consolidation Plan — L72](chroma-toolkit-consolidation-plan.md#^ref-5020e892-72-0) (line 72, col 0, score 0.85)
- [Polyglot S-expr Bridge: Python-JS-Lisp Interop — L332](polyglot-s-expr-bridge-python-js-lisp-interop.md#^ref-63a1cc28-332-0) (line 332, col 0, score 0.85)
- [TypeScript Patch for Tool Calling Support — L35](typescript-patch-for-tool-calling-support.md#^ref-7b7ca860-35-0) (line 35, col 0, score 0.87)
- [Chroma-Embedding-Refactor — L66](chroma-embedding-refactor.md#^ref-8b256935-66-0) (line 66, col 0, score 0.87)
- [TypeScript Patch for Tool Calling Support — L160](typescript-patch-for-tool-calling-support.md#^ref-7b7ca860-160-0) (line 160, col 0, score 0.87)
- [template-based-compilation — L21](template-based-compilation.md#^ref-f8877e5e-21-0) (line 21, col 0, score 0.85)
- [homeostasis-decay-formulas — L81](homeostasis-decay-formulas.md#^ref-37b5d236-81-0) (line 81, col 0, score 0.85)
- [homeostasis-decay-formulas — L61](homeostasis-decay-formulas.md#^ref-37b5d236-61-0) (line 61, col 0, score 0.85)
- [Universal Lisp Interface — L150](universal-lisp-interface.md#^ref-b01856b4-150-0) (line 150, col 0, score 0.85)
- [Model Selection for Lightweight Conversational Tasks — L52](model-selection-for-lightweight-conversational-tasks.md#^ref-d144aa62-52-0) (line 52, col 0, score 0.85)
- [homeostasis-decay-formulas — L40](homeostasis-decay-formulas.md#^ref-37b5d236-40-0) (line 40, col 0, score 0.85)
- [Migrate to Provider-Tenant Architecture — L39](migrate-to-provider-tenant-architecture.md#^ref-54382370-39-0) (line 39, col 0, score 0.87)
- [TypeScript Patch for Tool Calling Support — L88](typescript-patch-for-tool-calling-support.md#^ref-7b7ca860-88-0) (line 88, col 0, score 0.86)
- [Prometheus Observability Stack — L483](prometheus-observability-stack.md#^ref-e90b5a16-483-0) (line 483, col 0, score 0.85)
- [Prometheus Observability Stack — L480](prometheus-observability-stack.md#^ref-e90b5a16-480-0) (line 480, col 0, score 0.85)
- [TypeScript Patch for Tool Calling Support — L115](typescript-patch-for-tool-calling-support.md#^ref-7b7ca860-115-0) (line 115, col 0, score 0.85)
- [TypeScript Patch for Tool Calling Support — L534](typescript-patch-for-tool-calling-support.md#^ref-7b7ca860-534-0) (line 534, col 0, score 0.85)
- [System Scheduler with Resource-Aware DAG — L374](system-scheduler-with-resource-aware-dag.md#^ref-ba244286-374-0) (line 374, col 0, score 0.9)
- [Exception Layer Analysis — L63](exception-layer-analysis.md#^ref-21d5cc09-63-0) (line 63, col 0, score 0.87)
- [sibilant-meta-string-templating-runtime — L92](sibilant-meta-string-templating-runtime.md#^ref-2aafc801-92-0) (line 92, col 0, score 0.88)
- [Polyglot S-expr Bridge: Python-JS-Lisp Interop — L490](polyglot-s-expr-bridge-python-js-lisp-interop.md#^ref-63a1cc28-490-0) (line 490, col 0, score 0.86)
- [Promethean Agent Config DSL — L279](promethean-agent-config-dsl.md#^ref-2c00ce45-279-0) (line 279, col 0, score 0.88)
- [Cross-Language Runtime Polymorphism — L211](cross-language-runtime-polymorphism.md#^ref-c34c36a6-211-0) (line 211, col 0, score 0.89)
- [Promethean Web UI Setup — L440](promethean-web-ui-setup.md#^ref-bc5172ca-440-0) (line 440, col 0, score 0.92)
- [Mongo Outbox Implementation — L609](mongo-outbox-implementation.md#^ref-9c1acd1e-609-0) (line 609, col 0, score 0.91)
- [prom-lib-rate-limiters-and-replay-api — L306](prom-lib-rate-limiters-and-replay-api.md#^ref-aee4718b-306-0) (line 306, col 0, score 0.89)
- [heartbeat-simulation-snippets — L80](heartbeat-simulation-snippets.md#^ref-23e221e9-80-0) (line 80, col 0, score 0.88)
- [Lispy Macros with syntax-rules — L375](lispy-macros-with-syntax-rules.md#^ref-cbfe3513-375-0) (line 375, col 0, score 0.88)
- [Pure-Node Crawl Stack with Playwright and Crawlee — L400](pure-node-crawl-stack-with-playwright-and-crawlee.md#^ref-d527c05d-400-0) (line 400, col 0, score 0.9)
- [mystery-lisp-search-session — L106](mystery-lisp-search-session.md#^ref-513dc4c7-106-0) (line 106, col 0, score 0.91)
- [Ollama-LLM-Provider-for-Pseudo-Code-Transpiler — L151](ollama-llm-provider-for-pseudo-code-transpiler.md#^ref-b362e12e-151-0) (line 151, col 0, score 0.88)
- [sibilant-metacompiler-overview — L52](sibilant-metacompiler-overview.md#^ref-61d4086b-52-0) (line 52, col 0, score 0.91)
- [State Snapshots API and Transactional Projector — L303](state-snapshots-api-and-transactional-projector.md#^ref-509e1cd5-303-0) (line 303, col 0, score 0.87)
- [observability-infrastructure-setup — L348](observability-infrastructure-setup.md#^ref-b4e64f8c-348-0) (line 348, col 0, score 0.86)
- [Lisp-Compiler-Integration — L521](lisp-compiler-integration.md#^ref-cfee6d36-521-0) (line 521, col 0, score 0.86)
- [ecs-offload-workers — L427](ecs-offload-workers.md#^ref-6498b9d7-427-0) (line 427, col 0, score 0.86)
- [EidolonField — L205](eidolonfield.md#^ref-49d1e1e5-205-0) (line 205, col 0, score 0.88)
- [Chroma-Embedding-Refactor — L289](chroma-embedding-refactor.md#^ref-8b256935-289-0) (line 289, col 0, score 0.86)
- [Promethean Pipelines: Local TypeScript-First Workflow — L220](promethean-pipelines-local-typescript-first-workflow.md#^ref-6b63edca-220-0) (line 220, col 0, score 0.86)
- [prompt-programming-language-lisp — L56](prompt-programming-language-lisp.md#^ref-d41a06d1-56-0) (line 56, col 0, score 0.9)
- [universal-intention-code-fabric — L388](universal-intention-code-fabric.md#^ref-c14edce7-388-0) (line 388, col 0, score 0.91)
- [Promethean Full-Stack Docker Setup — L416](promethean-full-stack-docker-setup.md#^ref-2c2b48ca-416-0) (line 416, col 0, score 0.86)
- [RAG UI Panel with Qdrant and PostgREST — L349](rag-ui-panel-with-qdrant-and-postgrest.md#^ref-e1056831-349-0) (line 349, col 0, score 0.89)
- [Sibilant Meta-Prompt DSL — L120](sibilant-meta-prompt-dsl.md#^ref-af5d2824-120-0) (line 120, col 0, score 0.88)
- [Universal Lisp Interface — L187](universal-lisp-interface.md#^ref-b01856b4-187-0) (line 187, col 0, score 0.89)
- [shared-package-layout-clarification — L161](shared-package-layout-clarification.md#^ref-36c8882a-161-0) (line 161, col 0, score 0.86)
- [Local-Only-LLM-Workflow — L147](local-only-llm-workflow.md#^ref-9a8ab57e-147-0) (line 147, col 0, score 0.89)
- [markdown-to-org-transpiler — L272](markdown-to-org-transpiler.md#^ref-ab54cdd8-272-0) (line 272, col 0, score 0.86)
- [Event Bus MVP — L524](event-bus-mvp.md#^ref-534fe91d-524-0) (line 524, col 0, score 0.86)
- [Eidolon-Field-Optimization — L50](eidolon-field-optimization.md#^ref-40e05c14-50-0) (line 50, col 0, score 0.87)
- [2d-sandbox-field — L150](2d-sandbox-field.md#^ref-c710dc93-150-0) (line 150, col 0, score 0.86)
- [Voice Access Layer Design — L280](voice-access-layer-design.md#^ref-543ed9b3-280-0) (line 280, col 0, score 0.86)
- [polymorphic-meta-programming-engine — L190](polymorphic-meta-programming-engine.md#^ref-7bed0b9a-190-0) (line 190, col 0, score 0.86)
- [pm2-orchestration-patterns — L217](pm2-orchestration-patterns.md#^ref-51932e7b-217-0) (line 217, col 0, score 0.88)
- [Shared Package Structure — L185](shared-package-structure.md#^ref-66a72fc3-185-0) (line 185, col 0, score 0.89)
- [WebSocket Gateway Implementation — L630](websocket-gateway-implementation.md#^ref-e811123d-630-0) (line 630, col 0, score 0.89)
- [i3-config-validation-methods — L28](i3-config-validation-methods.md#^ref-d28090ac-28-0) (line 28, col 0, score 0.85)
- [Promethean Event Bus MVP v0.1 — L972](promethean-event-bus-mvp-v0-1.md#^ref-fe7193a2-972-0) (line 972, col 0, score 0.88)
- [promethean-system-diagrams — L169](promethean-system-diagrams.md#^ref-b51e19b4-169-0) (line 169, col 0, score 0.9)
- [lisp-dsl-for-window-management — L185](lisp-dsl-for-window-management.md#^ref-c5c5ff1c-185-0) (line 185, col 0, score 0.9)
- [Language-Agnostic Mirror System — L504](language-agnostic-mirror-system.md#^ref-d2b3628c-504-0) (line 504, col 0, score 0.91)
- [layer-1-uptime-diagrams — L129](layer-1-uptime-diagrams.md#^ref-4127189a-129-0) (line 129, col 0, score 0.85)
- [template-based-compilation — L44](template-based-compilation.md#^ref-f8877e5e-44-0) (line 44, col 0, score 0.88)
- [Interop and Source Maps — L497](interop-and-source-maps.md#^ref-cdfac40c-497-0) (line 497, col 0, score 0.9)
- [Functional Embedding Pipeline Refactor — L454](functional-embedding-pipeline-refactor.md#^ref-a4a25141-454-0) (line 454, col 0, score 0.91)
- [Promethean Documentation Pipeline Overview — L401](promethean-documentation-pipeline-overview.md#^ref-3a3bf2c9-401-0) (line 401, col 0, score 0.91)
- [Docops Feature Updates — L89](docops-feature-updates-3.md#^ref-cdbd21ee-89-0) (line 89, col 0, score 0.9)
- [Docops Feature Updates — L151](docops-feature-updates.md#^ref-2792d448-151-0) (line 151, col 0, score 0.9)
- [Promethean Pipelines — L420](promethean-pipelines.md#^ref-8b8e6103-420-0) (line 420, col 0, score 0.89)
- [plan-update-confirmation — L1435](plan-update-confirmation.md#^ref-b22d79c6-1435-0) (line 1435, col 0, score 0.88)
- [Docops Feature Updates — L119](docops-feature-updates.md#^ref-2792d448-119-0) (line 119, col 0, score 0.88)
- [Factorio AI with External Agents — L495](factorio-ai-with-external-agents.md#^ref-a4d90289-495-0) (line 495, col 0, score 0.88)
- [Local-First Intention→Code Loop with Free Models — L105](local-first-intention-code-loop-with-free-models.md#^ref-871490c7-105-0) (line 105, col 0, score 0.86)
- [compiler-kit-foundations — L588](compiler-kit-foundations.md#^ref-01b21543-588-0) (line 588, col 0, score 0.89)
- [Recursive Prompt Construction Engine — L147](recursive-prompt-construction-engine.md#^ref-babdb9eb-147-0) (line 147, col 0, score 0.85)
- [Functional Refactor of TypeScript Document Processing — L204](functional-refactor-of-typescript-document-processing.md#^ref-1cfae310-204-0) (line 204, col 0, score 0.92)
- [graph-ds — L427](graph-ds.md#^ref-6620e2f2-427-0) (line 427, col 0, score 0.92)
- [heartbeat-fragment-demo — L179](heartbeat-fragment-demo.md#^ref-dd00677a-179-0) (line 179, col 0, score 0.92)
- [homeostasis-decay-formulas — L200](homeostasis-decay-formulas.md#^ref-37b5d236-200-0) (line 200, col 0, score 0.92)
- [i3-bluetooth-setup — L201](i3-bluetooth-setup.md#^ref-5e408692-201-0) (line 201, col 0, score 0.92)
- [Ice Box Reorganization — L120](ice-box-reorganization.md#^ref-291c7d91-120-0) (line 120, col 0, score 0.92)
- [komorebi-group-window-hack — L262](komorebi-group-window-hack.md#^ref-dd89372d-262-0) (line 262, col 0, score 0.92)
- [Layer1SurvivabilityEnvelope — L201](layer1survivabilityenvelope.md#^ref-64a9f9f9-201-0) (line 201, col 0, score 0.92)
- [Model Selection for Lightweight Conversational Tasks — L184](model-selection-for-lightweight-conversational-tasks.md#^ref-d144aa62-184-0) (line 184, col 0, score 0.92)
- [Model Upgrade Calm-Down Guide — L189](model-upgrade-calm-down-guide.md#^ref-db74343f-189-0) (line 189, col 0, score 0.92)
- [set-assignment-in-lisp-ast — L148](set-assignment-in-lisp-ast.md#^ref-c5fba0a0-148-0) (line 148, col 0, score 0.93)
- [Vectorial Exception Descent — L95](vectorial-exception-descent.md#^ref-d771154e-95-0) (line 95, col 0, score 0.86)
- [Refactor Frontmatter Processing — L11](refactor-frontmatter-processing.md#^ref-cfbdca2f-11-0) (line 11, col 0, score 0.89)
- [Functional Refactor of TypeScript Document Processing — L306](functional-refactor-of-typescript-document-processing.md#^ref-1cfae310-306-0) (line 306, col 0, score 0.87)
- [zero-copy-snapshots-and-workers — L652](zero-copy-snapshots-and-workers.md#^ref-62bec6f0-652-0) (line 652, col 0, score 0.87)
- [Pure TypeScript Search Microservice — L859](pure-typescript-search-microservice.md#^ref-d17d3a96-859-0) (line 859, col 0, score 0.87)
- [Migrate to Provider-Tenant Architecture — L881](migrate-to-provider-tenant-architecture.md#^ref-54382370-881-0) (line 881, col 0, score 0.93)
- [Stateful Partitions and Rebalancing — L937](stateful-partitions-and-rebalancing.md#^ref-4330e8f0-937-0) (line 937, col 0, score 0.93)
- [Synchronicity Waves and Web — L214](synchronicity-waves-and-web.md#^ref-91295f3a-214-0) (line 214, col 0, score 0.93)
- [Dynamic Context Model for Web Components — L939](dynamic-context-model-for-web-components.md#^ref-f7702bf8-939-0) (line 939, col 0, score 0.93)
- [Factorio AI with External Agents — L568](factorio-ai-with-external-agents.md#^ref-a4d90289-568-0) (line 568, col 0, score 0.93)
- [Model Upgrade Calm-Down Guide — L371](model-upgrade-calm-down-guide.md#^ref-db74343f-371-0) (line 371, col 0, score 0.93)
- [Layer1SurvivabilityEnvelope — L526](layer1survivabilityenvelope.md#^ref-64a9f9f9-526-0) (line 526, col 0, score 0.92)
- [Promethean Documentation Pipeline Overview — L505](promethean-documentation-pipeline-overview.md#^ref-3a3bf2c9-505-0) (line 505, col 0, score 0.92)
- [Promethean Documentation Pipeline Overview — L514](promethean-documentation-pipeline-overview.md#^ref-3a3bf2c9-514-0) (line 514, col 0, score 0.86)
- [Self-Agency in AI Interaction — L263](self-agency-in-ai-interaction.md#^ref-49a9a860-263-0) (line 263, col 0, score 0.86)
- [Eidolon Field Abstract Model — L513](eidolon-field-abstract-model.md#^ref-5e8b2388-513-0) (line 513, col 0, score 0.85)
- [Obsidian Templating Plugins Integration Guide — L317](obsidian-templating-plugins-integration-guide.md#^ref-b39dc9d4-317-0) (line 317, col 0, score 0.91)
- [Agent Reflections and Prompt Evolution — L417](agent-reflections-and-prompt-evolution.md#^ref-bb7f0835-417-0) (line 417, col 0, score 0.91)
- [NPU Voice Code and Sensory Integration — L117](npu-voice-code-and-sensory-integration.md#^ref-5a02283e-117-0) (line 117, col 0, score 0.91)
- [Debugging Broker Connections and Agent Behavior — L266](debugging-broker-connections-and-agent-behavior.md#^ref-73d3dbf6-266-0) (line 266, col 0, score 0.91)
- [Eidolon Field Abstract Model — L674](eidolon-field-abstract-model.md#^ref-5e8b2388-674-0) (line 674, col 0, score 0.87)
- [Dynamic Context Model for Web Components — L1053](dynamic-context-model-for-web-components.md#^ref-f7702bf8-1053-0) (line 1053, col 0, score 0.87)
- [Promethean State Format — L319](promethean-state-format.md#^ref-23df6ddb-319-0) (line 319, col 0, score 0.87)
- [Dynamic Context Model for Web Components — L1270](dynamic-context-model-for-web-components.md#^ref-f7702bf8-1270-0) (line 1270, col 0, score 0.87)
- [Admin Dashboard for User Management — L245](admin-dashboard-for-user-management.md#^ref-2901a3e9-245-0) (line 245, col 0, score 0.87)
- [Promethean Pipelines — L547](promethean-pipelines.md#^ref-8b8e6103-547-0) (line 547, col 0, score 0.87)
- [Model Upgrade Calm-Down Guide — L447](model-upgrade-calm-down-guide.md#^ref-db74343f-447-0) (line 447, col 0, score 0.87)
- [Promethean-Copilot-Intent-Engine — L422](promethean-copilot-intent-engine.md#^ref-ae24a280-422-0) (line 422, col 0, score 0.87)
- [Promethean Documentation Pipeline Overview — L656](promethean-documentation-pipeline-overview.md#^ref-3a3bf2c9-656-0) (line 656, col 0, score 0.87)
- [Self-Agency in AI Interaction — L301](self-agency-in-ai-interaction.md#^ref-49a9a860-301-0) (line 301, col 0, score 0.87)
- [Duck's Self-Referential Perceptual Loop — L182](ducks-self-referential-perceptual-loop.md#^ref-71726f04-182-0) (line 182, col 0, score 0.87)
- [Promethean Documentation Pipeline Overview — L732](promethean-documentation-pipeline-overview.md#^ref-3a3bf2c9-732-0) (line 732, col 0, score 0.87)
- [Promethean-Copilot-Intent-Engine — L229](promethean-copilot-intent-engine.md#^ref-ae24a280-229-0) (line 229, col 0, score 0.87)
- [i3-layout-saver — L79](i3-layout-saver.md#^ref-31f0166e-79-0) (line 79, col 0, score 0.87)
- [Cross-Target Macro System in Sibilant — L148](cross-target-macro-system-in-sibilant.md#^ref-5f210ca2-148-0) (line 148, col 0, score 0.91)
- [Local-Offline-Model-Deployment-Strategy — L232](local-offline-model-deployment-strategy.md#^ref-ad7f1ed3-232-0) (line 232, col 0, score 0.86)
- [Promethean Agent DSL TS Scaffold — L818](promethean-agent-dsl-ts-scaffold.md#^ref-5158f742-818-0) (line 818, col 0, score 0.86)
- [ecs-scheduler-and-prefabs — L376](ecs-scheduler-and-prefabs.md#^ref-c62a1815-376-0) (line 376, col 0, score 0.91)
- [Chroma Toolkit Consolidation Plan — L636](chroma-toolkit-consolidation-plan.md#^ref-5020e892-636-0) (line 636, col 0, score 0.85)
- [Diagrams — L502](chunks/diagrams.md#^ref-45cd25b5-502-0) (line 502, col 0, score 0.85)
- [JavaScript — L396](chunks/javascript.md#^ref-c1618c66-396-0) (line 396, col 0, score 0.85)
- [Math Fundamentals — L362](chunks/math-fundamentals.md#^ref-c6e87433-362-0) (line 362, col 0, score 0.85)
- [Services — L283](chunks/services.md#^ref-75ea4a6a-283-0) (line 283, col 0, score 0.85)
- [field-dynamics-math-blocks — L877](field-dynamics-math-blocks.md#^ref-7cfc230d-877-0) (line 877, col 0, score 0.85)
- [field-interaction-equations — L907](field-interaction-equations.md#^ref-b09141b7-907-0) (line 907, col 0, score 0.85)
- [field-node-diagram-outline — L637](field-node-diagram-outline.md#^ref-1f32c94a-637-0) (line 637, col 0, score 0.85)
- [field-node-diagram-set — L648](field-node-diagram-set.md#^ref-22b989d5-648-0) (line 648, col 0, score 0.85)
- [field-node-diagram-visualizations — L538](field-node-diagram-visualizations.md#^ref-e9b27b06-538-0) (line 538, col 0, score 0.85)
- [Fnord Tracer Protocol — L1018](fnord-tracer-protocol.md#^ref-fc21f824-1018-0) (line 1018, col 0, score 0.85)
- [graph-ds — L446](graph-ds.md#^ref-6620e2f2-446-0) (line 446, col 0, score 0.95)
- [Promethean Chat Activity Report — L145](promethean-chat-activity-report.md#^ref-18344cf9-145-0) (line 145, col 0, score 0.95)
- [Prometheus Observability Stack — L599](prometheus-observability-stack.md#^ref-e90b5a16-599-0) (line 599, col 0, score 0.95)
- [Prompt_Folder_Bootstrap — L279](prompt-folder-bootstrap.md#^ref-bd4f0976-279-0) (line 279, col 0, score 0.95)
- [Protocol_0_The_Contradiction_Engine — L250](protocol-0-the-contradiction-engine.md#^ref-9a93a756-250-0) (line 250, col 0, score 0.95)
- [Provider-Agnostic Chat Panel Implementation — L315](provider-agnostic-chat-panel-implementation.md#^ref-43bfe9dd-315-0) (line 315, col 0, score 0.95)
- [Pure TypeScript Search Microservice — L673](pure-typescript-search-microservice.md#^ref-d17d3a96-673-0) (line 673, col 0, score 0.95)
- [Reawakening Duck — L202](reawakening-duck.md#^ref-59b5670f-202-0) (line 202, col 0, score 0.95)
- [schema-evolution-workflow — L662](schema-evolution-workflow.md#^ref-d8059b6a-662-0) (line 662, col 0, score 0.95)
- [sibilant-macro-targets — L274](sibilant-macro-targets.md#^ref-c5c9a5c6-274-0) (line 274, col 0, score 0.95)
- [js-to-lisp-reverse-compiler — L343](js-to-lisp-reverse-compiler.md#^ref-58191024-343-0) (line 343, col 0, score 0.87)
- [Chroma Toolkit Consolidation Plan — L524](chroma-toolkit-consolidation-plan.md#^ref-5020e892-524-0) (line 524, col 0, score 0.87)
- [Services — L228](chunks/services.md#^ref-75ea4a6a-228-0) (line 228, col 0, score 0.87)
- [eidolon-field-math-foundations — L801](eidolon-field-math-foundations.md#^ref-008f2ac0-801-0) (line 801, col 0, score 0.87)
- [Migrate to Provider-Tenant Architecture — L1205](migrate-to-provider-tenant-architecture.md#^ref-54382370-1205-0) (line 1205, col 0, score 0.87)
- [Per-Domain Policy System for JS Crawler — L957](per-domain-policy-system-for-js-crawler.md#^ref-c03020e1-957-0) (line 957, col 0, score 0.87)
- [Prompt_Folder_Bootstrap — L819](prompt-folder-bootstrap.md#^ref-bd4f0976-819-0) (line 819, col 0, score 0.87)
- [schema-evolution-workflow — L1028](schema-evolution-workflow.md#^ref-d8059b6a-1028-0) (line 1028, col 0, score 0.87)
- [Stateful Partitions and Rebalancing — L1089](stateful-partitions-and-rebalancing.md#^ref-4330e8f0-1089-0) (line 1089, col 0, score 0.87)
- [Event Bus Projections Architecture — L111](event-bus-projections-architecture.md#^ref-cf6b9b17-111-0) (line 111, col 0, score 0.91)
<!-- GENERATED-SECTIONS:DO-NOT-EDIT-ABOVE -->
